<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/XDSDK-Doc/blog/rss.xml" title="XDSDK 文档中心 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/XDSDK-Doc/blog/atom.xml" title="XDSDK 文档中心 Blog Atom Feed"><title data-react-helmet="true">iOS快速开始 | XDSDK 文档中心</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="iOS快速开始 | XDSDK 文档中心"><meta data-react-helmet="true" name="description" content="心动 SDK（iOS）对接文档"><meta data-react-helmet="true" property="og:description" content="心动 SDK（iOS）对接文档"><meta data-react-helmet="true" property="og:url" content="https://xindong.github.io/XDSDK-Doc/ios"><link data-react-helmet="true" rel="shortcut icon" href="/XDSDK-Doc/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://xindong.github.io/XDSDK-Doc/ios"><link rel="stylesheet" href="/XDSDK-Doc/styles.98143238.css">
<link rel="stylesheet" href="/XDSDK-Doc/main.c62259f1.css">
<link rel="preload" href="/XDSDK-Doc/styles.04ea6341.js" as="script">
<link rel="preload" href="/XDSDK-Doc/runtime~main.aa48e010.js" as="script">
<link rel="preload" href="/XDSDK-Doc/main.00965467.js" as="script">
<link rel="preload" href="/XDSDK-Doc/1.ab684445.js" as="script">
<link rel="preload" href="/XDSDK-Doc/2.f8601547.js" as="script">
<link rel="preload" href="/XDSDK-Doc/22.95066253.js" as="script">
<link rel="preload" href="/XDSDK-Doc/935f2afb.84422a50.js" as="script">
<link rel="preload" href="/XDSDK-Doc/17896441.f8f7aa8e.js" as="script">
<link rel="preload" href="/XDSDK-Doc/32fcddf3.0cc07d93.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/XDSDK-Doc/"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a><a class="navbar__item navbar__link" href="/XDSDK-Doc/">XDSDK</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/xindong/XDSDK-Doc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/XDSDK-Doc/"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/XDSDK-Doc/">XDSDK</a></li><li class="menu__list-item"><a href="https://github.com/xindong/XDSDK-Doc" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">接入文档</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XDSDK-Doc/unity2.x">Unity2.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XDSDK-Doc/">Unity3.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XDSDK-Doc/android">Android</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/XDSDK-Doc/ios">iOS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">功能介绍</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/fun-db">TapDB (XDSDK 中使用)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/tap-fun-db">TapDB (单独使用)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/tap-moment">动态 2.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/tap-fun-moment">动态 3.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/fun-service">服务端</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/XDSDK-Doc/xd-faq">常见问题</a></li><li class="menu__list-item"><a class="menu__link" href="/XDSDK-Doc/xdsdk-changelog">更新日志</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">iOS快速开始</h1></header><div class="markdown"><p>心动 SDK（iOS）对接文档</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1心动sdk介绍"></a>1.心动SDK介绍<a class="hash-link" href="#1心动sdk介绍" title="Direct link to heading">#</a></h2><p>心动SDK主要为游戏提供登录，支付等功能。登录流程和支付流程都需要客户端和服务端同时参与。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="11登录流程"></a>1.1.登录流程<a class="hash-link" href="#11登录流程" title="Direct link to heading">#</a></h3><p><img src="https://static.tapdb.net/web/res/img/upload/2017/06/27/01.png" alt="unitypackage import">  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="12支付流程"></a>1.2.支付流程<a class="hash-link" href="#12支付流程" title="Direct link to heading">#</a></h3><p><img src="https://static.tapdb.net/web/res/img/upload/2017/06/27/02.png" alt="unitypackage import">  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="13sdk集成流程"></a>1.3.SDK集成流程<a class="hash-link" href="#13sdk集成流程" title="Direct link to heading">#</a></h3><p><img src="https://static.tapdb.net/web/res/img/upload/2017/07/07/01.png" alt="unitypackage import">  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2申请心动appid"></a>2.申请心动AppID<a class="hash-link" href="#2申请心动appid" title="Direct link to heading">#</a></h2><p>参阅“心动AppID申请介绍”文档，申请心动AppID，获得心动AppID、心动AppKey、微信AppID、QQ AppID。其中心动AppID主要是客户端对接时使用，AppKey主要是服务端对接支付回调时使用。</p><span style="color:#f00;padding:0.2rem">注意，如果游戏需要使用微信分享功能，必须使用心动提供的微信AppID，否则会导致微信登录失败。</span><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3需要遵守的规则"></a>3.需要遵守的规则<a class="hash-link" href="#3需要遵守的规则" title="Direct link to heading">#</a></h2><p>对接过程中，为了避免出现一些奇怪的问题，无特殊需求情况下，请尽量遵守下面的规则。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="31回调依赖"></a>3.1.回调依赖<a class="hash-link" href="#31回调依赖" title="Direct link to heading">#</a></h3><p>游戏调用SDK的功能，SDK通常会以回调形式通知到游戏，除了必须依赖的回调（如登录成功回调），其它回调尽可能不依赖。此场景适用于登录、打开用户中心、支付。</p><p>比如游戏登录，通常是游戏提供一个登录按钮，用户点击后调用SDK登录，此时有两种处理方式。A、点击后，游戏隐藏登录按钮或使用loading图标盖住，等收到SDK登录失败回调时，才会再次展现登录按钮或移除loading。B、无论是否收到回调，都保证按钮处理可点状态。</p><p>建议游戏使用后者，防止意外情况下，流程无法走通，用户无法继续操作的情况。另外也可以采用后者的优化版，即用户点击后，仅屏蔽按钮1秒钟，这样可以防止用户反复点击导致SDK接口被反复调用。</p><p>总之游戏尽可能保证功能一直处于可用状态，而不依赖SDK的状态。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4接入sdk"></a>4.接入SDK<a class="hash-link" href="#4接入sdk" title="Direct link to heading">#</a></h2><span style="color:#f00;padding:0.2rem">在编译选项‘Other Linker Flags’中加入「-ObjC」和 「-all_load」。</span><p><strong>重要:4.3.1版本加入Swift混编，如编译遇到Swift编译报错，可加入一个Swift空文件解决。libs文件夹中已提供</strong></p><p><strong>Swift Language Version 设置为 Swift 5</strong></p><p><strong>BuildSetting中,Always Embed Swift Standard Libraries设置为YES</strong></p><p><strong>BuildSetting中,Runpath Search Paths 确保添加 @executable_path/Frameworks</strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="41获取sdk"></a>4.1.获取SDK<a class="hash-link" href="#41获取sdk" title="Direct link to heading">#</a></h3><p>从心动平台处获取SDK，其中主要的文件或目录用途如下。</p><table><thead><tr><th>目录或文件</th><th>用途</th></tr></thead><tbody><tr><td>XdComPlatform.framework</td><td>心动SDK的主要库文件，需要添加到项目依赖中</td></tr><tr><td>XDSDKResouce.bundle</td><td>心动SDK需要或依赖的资源文件，需要保证文件被添加到了Xcode的“Copy Bundle Resources”中(确保勾选了Copy items if needed)</td></tr><tr><td>libs</td><td>心动SDK依赖的其它库文件，需要添加到项目依赖中</td></tr><tr><td>libs/TapSDK.framework</td><td>TapSDK</td></tr><tr><td>libs/TDSCommon.framework</td><td>Tap工具类</td></tr><tr><td>libs/TDSCommonResource</td><td>TDSCommon依赖的资源文件</td></tr><tr><td>libs/TDSMomentResource</td><td>TapSDK/TDSMoment依赖的资源文件</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="42添加系统依赖库"></a>4.2.添加系统依赖库<a class="hash-link" href="#42添加系统依赖库" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">Security</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CFNetwork</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">UIKit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">QuartzCore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Foundation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CoreGraphics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CoreTelephony</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">SystemConfiguration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Webkit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libiconv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libsqlite3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token number">0.</span><span class="token plain">tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libc</span><span class="token operator">++</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libz</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libicucore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 4.1.0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">AuthenticationServices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 4.3.12</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">AppTrackingTransparency</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework\AdServices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 5.0.0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">MobileCoreServices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">framework</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="43设置url-types"></a>4.3.设置URL Types<a class="hash-link" href="#43设置url-types" title="Direct link to heading">#</a></h3><p>需要在Xcode中设置多个URL Types，URL Types主要是需要设置URL Schemes，其它选项可任意填写。按照下面表格的内容填写，注意替换其中的各项AppID。</p><table><thead><tr><th>URL Schemes</th><th>用途</th><th>示例</th><th>备注</th></tr></thead><tbody><tr><td>XD-{心动AppID}</td><td>用于支付宝支付后跳回</td><td>XD-ci2dos1ktzsca4f</td><td></td></tr><tr><td>{微信AppID}</td><td>用于微信授权登录后跳回</td><td>wx19f231d77ac408d9</td><td>微信AppID自带前缀wx，不用再次添加</td></tr><tr><td>tencent{QQ AppID}</td><td>用于QQ授权登录后跳回</td><td>tencent317081</td><td>如果给到的心动AppID没有对应的QQ AppID，可以不配置该项</td></tr><tr><td>tt{TapTap AppID}</td><td>用户TapTap授权登录后跳回</td><td>tt123456</td><td></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="44配置infoplist"></a>4.4.配置info.plist<a class="hash-link" href="#44配置infoplist" title="Direct link to heading">#</a></h3><p>修改项目的info.plist，在<code>&lt;dict&gt;</code>节点中添加下列内容。修改的内容主要为了保证QQ和微信登录能够正常运行。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;array&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;tapsdk&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqq&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqapi&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;wtloginmqq2&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkapiV4&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkapiV3&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkapiV2&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqwpa&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqOpensdkSSoLogin&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqgamebindinggroup&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkfriend&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqzone&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;weixin&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;wechat&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 4.1.0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;weixinULAPI&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/array&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 4.3.12</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSUserTrackingUsageDescription&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;请允许xxx获取并使用您的IDFA,来为您提供更好的服务&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;true/&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/dict&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>更新SDK 4.3.12 后
iOS 14开始，获取IDFA需要配置单独权限声明，在 info.plist 中配置 NSUserTrackingUsageDescription 及描述文案。如：请允许xxx获取并使用您的IDFA,来为您提供更好的服务。</p><p>系统依赖项检查是否添加 <code>AppTrackingTransparency.framework\AdServices.framework</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="45配置工程capability"></a>4.5.配置工程capability<a class="hash-link" href="#45配置工程capability" title="Direct link to heading">#</a></h3><p>更新SDK 4.1.0之后， </p><span style="color:#f00;padding:0.2rem">需要在xcode工程中添加两项capability：Associated Domains \ Sign in with apple.</span><p>如下图:</p><p><img alt="unitypackage import" src="/XDSDK-Doc/assets/images/4-4d6592caef2646f1d917d61f3e27572c.png">  </p><p>Associated Domains添加一项，格式为『applinks + 域名』如「applinks:<a href="http://www.xd.com%E3%80%8D%E3%80%82" target="_blank" rel="noopener noreferrer">www.xd.com」。</a></p><span style="color:#f00;padding:0.2rem">域名为游戏官网地址，请联系平台方确认</span><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="46处理第三方应用跳回事件"></a>4.6.处理第三方应用跳回事件<a class="hash-link" href="#46处理第三方应用跳回事件" title="Direct link to heading">#</a></h3><p>在AppDelegate.m中增加如下三个方法，如果已经存在这些方法，在其中追加相应的处理代码即可。</p><span style="color:#f00;padding:0.2rem">SDK 4.1.0 新增universalLink处理</span><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">UIApplication </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">openURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSURL </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">url</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">sourceApplication</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">sourceApplication</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">annotation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">annotation </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore HandleXDOpenURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">UIApplication </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">app</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">openURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSURL </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">url</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">options</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSDictionary</span><span class="token operator">&lt;</span><span class="token plain">UIApplicationOpenURLOptionsKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">id</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">options </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore HandleXDOpenURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">UIApplication </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application continueUserActivity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSUserActivity </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">userActivity restorationHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">^</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSArray</span><span class="token operator">&lt;</span><span class="token plain">id</span><span class="token operator">&lt;</span><span class="token plain">UIUserActivityRestoring</span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> _Nullable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">restorationHandler </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore handleOpenUniversalLink</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">userActivity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="5接口调用"></a>5.接口调用<a class="hash-link" href="#5接口调用" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="51配置sdk登录选项"></a>5.1.配置SDK登录选项<a class="hash-link" href="#51配置sdk登录选项" title="Direct link to heading">#</a></h3><p>心动SDK提供配置苹果登录、TapTap、QQ、微信登录、游客登录的显示与隐藏以及登录方式。</p><span style="color:#f00;padding:0.2rem">请勿直接复制以下代码，根据游戏实际需求选择调用。(以下API为旧接口，建议直接使用自定义入口顺序功能)</span><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore hideGuest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">//隐藏游客登录</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore hideWX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">//隐藏微信登录</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore hideQQ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">//隐藏QQ登录</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore showVC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token comment" style="color:rgb(98, 114, 164)">//显示VeryCD登录（此接口供老游戏兼容，新游戏不建议调用）</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCOre setQQWeb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">//设置QQ为Web登录方式</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore setWXWeb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token comment" style="color:rgb(98, 114, 164)">//设置微信为Web 扫码登录方式</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore hideTapTap</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token comment" style="color:rgb(98, 114, 164)">//隐藏TapTap登录</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><span style="color:#f00;padding:0.2rem">SDK版本3.2.17添加了新接口，自定义登录按钮及顺序。可以在SDK初始化之前调用。具体说明如下：</span><span style="color:#f00;padding:0.2rem">SDK版本4.1.0添加了新入口：苹果登录</span><p> 自定义登录入口。共五种，其中主要两种，次要三种。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1、默认显示为：微信、qq、游客、苹果、taptap"></a>1、默认显示为：微信、QQ、游客、苹果、TapTap<a class="hash-link" href="#1、默认显示为：微信、qq、游客、苹果、taptap" title="Direct link to heading">#</a></h4><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2、各登录方式对应名称如下："></a>2、各登录方式对应名称如下：<a class="hash-link" href="#2、各登录方式对应名称如下：" title="Direct link to heading">#</a></h4><ul><li>微信登录：WX_LOGIN，</li><li>taptap登录：TAPTAP_LOGIN，</li><li>QQ登录：QQ_LOGIN，</li><li>游客登录：GUEST_LOGIN，</li><li>心动登录：XD_LOGIN</li><li>苹果登录：APPLE_LOGIN</li></ul><span style="color:#f00;padding:0.2rem">由于苹果审核要求，iOS13 显示第三方登录的同时必须显示苹果登录(建议位置靠前)</span><span style="color:#f00;padding:0.2rem">SDK 在iOS12及以下、安卓中使用web实现苹果登录，但是若新游戏iOS版未上架appstore，无法使用web版苹果登录，游戏需在iOS应用上架之后，才打开iOS12系统及以下和安卓的苹果登录入口。</span><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3、例，传入的数组。"></a>3、例，传入的数组。<a class="hash-link" href="#3、例，传入的数组。" title="Direct link to heading">#</a></h4><p> @[@&quot;APPLE_LOGIN&quot;,@&quot;WX_LOGIN&quot;,@&quot;TAPTAP_LOGIN&quot;,@&quot;GUEST_LOGIN&quot;,@&quot;QQ_LOGIN&quot;]</p><p>注：</p><ul><li>传入为空或nil，则当做隐藏所有按钮，直接显示心动登录。</li><li>最多只能显示5种登录方式。</li><li>登录按钮TapTap和心动登录不能同时显示</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// 自定义登录按钮及顺序</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore setLoginEntries</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token operator">@</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;APPLE_LOGIN&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;WX_LOGIN&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;TAPTAP_LOGIN&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;GUEST_LOGIN&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;QQ_LOGIN&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4、自定义登录入口"></a>4、自定义登录入口<a class="hash-link" href="#4、自定义登录入口" title="Direct link to heading">#</a></h4><span style="color:#f00;padding:0.2rem">XDSDK 4.3.1开始，支持游戏自定义登录入口。入口素材由平台提供</span><p>增加自定义登录接口（iOS:AutoLogin/TapTapLogin/AppleLogin/GuestLogin,Android:AutoLogin/TapTapLogin），游戏绘制登录按钮后调用.</p><p><strong>调用方法 ：</strong> 调用autologin，根据登录回调看是否自动登录成功，如果自动登录失败，回调信息为『自动登录失败』，如果没有成功就显示登录界面，用户点击不同登录按钮然后调用对应登录:taptaplogin等。</p><p><strong>（自定义绘制登录按钮时，点击防沉迷切换账号按钮会回调登录取消）</strong></p><p>接口如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// 自动登录（若有上次登录记录，则会直接登录）</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> bool </span><span class="token function" style="color:rgb(80, 250, 123)">AutoLogin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// TapTap登录</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">TapTapLogin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 苹果登录</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">AppleLogin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 游客登录</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">GuestLogin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例：</p><p><img alt="unitypackage import" src="/XDSDK-Doc/assets/images/5-f16c368243c65551011faef60778166f.jpg">  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="52实现sdk协议"></a>5.2.实现SDK协议<a class="hash-link" href="#52实现sdk协议" title="Direct link to heading">#</a></h3><p>游戏调用SDK接口后，结果以Protocol方式回调给游戏，游戏需要实现XDCallback.h中声明的方法。</p><p>代码示例：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore setCallBack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">YourCallBack new</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token macro property"> &quot;YourCallBack.h&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">@interface</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">YourCallBack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">&lt;</span><span class="token plain">XDCallback</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">@end</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">@implementation</span><span class="token plain"> YourCallBack</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*初始化成功*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onInitSucceed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*初始化失败*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onInitFailed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nullable NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">error_msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*登录成功*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*access_token:登录成功，获取到用户的token。游戏根据token获取用户信息。*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onLoginSucceed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">access_token</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*登录失败*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*error_msg: 登录失败的报错信息*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onLoginFailed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nullable NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">error_msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*登录取消*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onLoginCanceled</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*游客绑定成功*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*access_token: 游客升级成功，获取新的token。</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  后续如需使用 token，务必使用回调给的新 token。但已生效的会话无须处理。</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  */</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onBindGuestSucceed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonull NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">access_token</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 绑定taptap成功</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// @param profile 返回用户信息</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onBindTaptapSucceed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">profile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*登出成功*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onLogoutSucceed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*支付完成*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onPayCompleted</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*支付失败*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*error_msg:支付失败的错误信息*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onPayFailed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nullable NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">error_msg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*支付取消*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onPayCanceled</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/* 有未完成的订单回调，比如：礼包码.注意：多个未完成订单会在一个数组中一起回调。（只会在登录状态下回调）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">   @param paymentInfos 订单信息数组。</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">   单个未完成订单信息包含：   TransactionIdentifier ：订单标识 ，恢复购买时需要回传</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">                                     Product_Id ：商品ID，</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">                                        Quantity：商品数量</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">restoredPayment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSArray</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">paymentInfos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 打开协议页面成功成功</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onOpenProtocolSuccess</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 打开协议页面成功失败</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onOpenProtocolFail</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/* 用户同意隐私协议 **/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onAgreeProtocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="53初始化sdk"></a>5.3.初始化SDK<a class="hash-link" href="#53初始化sdk" title="Direct link to heading">#</a></h3><p>初始化心动SDK，请统一使用下述接口，调用该接口是调用其它功能接口的前置必要条件。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> 初始化sdk，包含心动SDK，TapDB统计SDK</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="display:inline-block;color:rgb(98, 114, 164)">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> @param appid 心动appid</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> @param orientation 屏幕方向</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> @param channel 渠道号</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> @param version 版本号</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> @param enableTapdb 是否开启TapDB</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">appid orientation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">orientation</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     channel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">channel version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">version</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> enableTapdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">enableTapdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">@</span><span class="token plain">param appid 心动appid</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">@</span><span class="token plain">param orientation 屏幕方向</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">@</span><span class="token plain">param channel 渠道号</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">@</span><span class="token plain">param version 版本号</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">@</span><span class="token plain">param enableTapdb 是否开启TapDB</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">@</span><span class="token plain">param enableTapdb 是否开启Moment</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token operator">*</span><span class="token operator">/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">appid</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> orientation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">orientation</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     channel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">channel</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">     version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">version</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> enableTapdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">enableTapdb</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">enableMoment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">enableMoment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调。</p><span style="color:#f00;padding:0.2rem">注意：<p>1）其他接口请在获取到初始化成功回调之后进行调用。
2）已经单独接入 TapDB 的项目请勿开启内置 TapDB 统计功能。
3）SDK 初始化时如果未设置或无法获取到 TapDB AppId，TapDB 统计服务将自动设置为关闭。
其他注意事项请参考 Unity 文档 TapDB 章节或与平台联系。</p></span><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>初始化成功</td><td>-(void)onInitSucceed</td></tr><tr><td>初始化失败</td><td>-(void)onInitFailed:(nullable NSString*)error_msg</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="54登录"></a>5.4.登录<a class="hash-link" href="#54登录" title="Direct link to heading">#</a></h3><p>调用该接口进行登录。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/*登录*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">login</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调。</p><span style="color:#f00;padding:0.2rem">获取、查看用户信息以及支付接口请在获取到登录成功回调之后调用。</span><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>登录成功</td><td>- (void)onLoginSucceed:(nonnull NSString*)access_token;</td></tr><tr><td>登录失败</td><td>- (void)onLoginFailed:(nullable NSString*)error_msg;</td></tr><tr><td>登录取消</td><td>- (void)onLoginCanceled;</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="55获取access-token"></a>5.5.获取Access Token<a class="hash-link" href="#55获取access-token" title="Direct link to heading">#</a></h3><p>调用该接口获取当前登录用户的access token。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @return 当前登录用户的access token，无登录用户时，返回空字符串</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nullable NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">getAccessToken</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="56获取当前登录状态"></a>5.6.获取当前登录状态<a class="hash-link" href="#56获取当前登录状态" title="Direct link to heading">#</a></h3><p>调用该接口获取当前登录状态。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @return YES表示已经登录，NO表示未登录</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">isLoggedIn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="57打开用户中心"></a>5.7.打开用户中心<a class="hash-link" href="#57打开用户中心" title="Direct link to heading">#</a></h4><p>调用该接口打开用户中心界面，用户可以在该界面进行登出和登录操作，游戏注意正确处理回调。在未登录状态，无法打开用户中心。在用户中心中，用户可进行登出操作，此时交互界面将消失。游戏需要提供引导用户重新进行登录的操作界面。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/*</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @return YES,开启成功 NO，开启失败</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">openUserCenter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="58发起支付"></a>5.8.发起支付<a class="hash-link" href="#58发起支付" title="Direct link to heading">#</a></h3><span style="color:#f00;padding:0.2rem">为了收到支付回调，需要在应用启动后就设置好支付相关功能。</span><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">BOOL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">UIApplication</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">application didFinishLaunchingWithOptions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSDictionary</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">launchOptions</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 初始化支付</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDCore setupXDStore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>5.8.1 正常支付</strong></p><p>调用该接口发起支付。当前版本SDK仅支持AppStore支付。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @param info 支付相关信息，注意key和value都是字符串类型</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">requestProduct</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonull NSDictionary</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">productInfo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其中info的字段如下。</p><table><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>Product_Name</td><td>是</td><td>商品名称，建议以游戏名称开头，方便财务对账</td></tr><tr><td>Product_Id</td><td>是</td><td>商品ID，到AppStore购买的商品</td></tr><tr><td>Product_Price</td><td>是</td><td>商品价格（单位分），对于AppStore支付，该字段没有用处，但是需要传递真实金额，有多处需要用到</td></tr><tr><td>Sid</td><td>是</td><td>所在服务器ID，不能有特殊字符，服务端支付回调会包含该字段</td></tr><tr><td>Role_Id</td><td>否</td><td>支付角色ID，服务端支付回调会包含该字段</td></tr><tr><td>OrderId</td><td>否</td><td>游戏侧订单号，服务端支付回调会包含该字段</td></tr><tr><td>EXT</td><td>否</td><td>额外信息，最长512个字符，服务端支付回调会包含该字段。可用于标记区分充值回调地址，如需使用该功能，请联系平台进行配置。代码示例：[prdInfo setObject:@&quot;{\&quot;payCallbackCode\&quot;:1}&quot; forKey:@&quot;EXT&quot;];</td></tr></tbody></table><span style="color:#f00;padding:0.2rem">EXT 信息可能会被篡改，请勿信任该参数内容派发商品。</span><p><strong>5.8.2 恢复支付</strong></p><span style="color:#f00;padding:0.2rem">恢复支付逻辑，SDK 4.0.1之后添加。</span><p>优化前：</p><p>在玩家第一笔掉单时，SDK 一直处于等待接收收据的状态，此时，
用户一直在游戏中，苹果随时可能发送收据给 SDK，一旦发送，SDK 就会通知游戏发送道具；
用户关闭游戏（杀进程或退后台），此时 SDK 不再接收苹果收据。导致即使这期间如果苹果有发送收据来，SDK 也收不到。除非玩家第二次充值，苹果会连同上一笔未完成订单一次性发送，造成玩家同时收到两笔道具的情况。</p><p>优化后：</p><p>当玩家再次打开游戏，SDK 再次向苹果请求一次收据信息。如有掉单的收据，且玩家登录成功后，则通知游戏，游戏来收到通知后来决定是否要补发道具。</p><span style="color:#f00;padding:0.2rem">游戏内购流程图：</span><p><img alt="unitypackage import" src="/XDSDK-Doc/assets/images/3-464186a03f3475216d647ffb244ae726.png">  </p><span style="color:#f00;padding:0.2rem">注意: 如果有遗留未完成订单，在接收到恢复订单回调后，(若单个用户可能拥有多个账号，可以请求用户确认后）调用恢复订单接口。</span><p>说明：</p><p>在掉单的情况下，SDK只能获取订单的基本信息，如商品ID、苹果侧订单ID（非游戏生成order_id）和商品数量，不能直接对应到用户，所以无法直接兑换商品。</p><p>游戏在收到掉单回调之后，可以弹窗请用户确认是否需要恢复商品，如需要，则用回调提供的已有参数，加上其他需要的参数，如角色ID，服务器ID等，使用恢复订单接口恢复该商品。</p><span style="color:#f00;padding:0.2rem">SDK会提供测试包，供游戏使用沙盒测试（购买之后会造成掉单），游戏调用恢复接口如果成功到账则为测试成功。</span><p>游戏内弹窗示例：</p><p><img alt="unitypackage import" src="/XDSDK-Doc/assets/images/1-17c357a11358a9a2c8f559e875c9b6e6.jpg"> </p><p>回调方法</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/// 有未完成的订单回调，比如：礼包码.注意：多个未完成订单会在一个数组中一起回调。（只会在登录状态下回调）</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// @param paymentInfos 订单信息数组。</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 单个未完成订单信息包含：   TransactionIdentifier ：订单标识 ，恢复购买时需要回传</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">///                                   Product_Id ：商品ID，</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">///                                      Quantity：商品数量</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">restoredPayment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonnull NSArray</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">paymentInfos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>恢复订单接口</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @param info 支付相关信息，注意key和value都是字符串类型</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">restoreProduct</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonull NSDictionary</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">productInfo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其中productInfo的字段如下。</p><table><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>TransactionIdentifier</td><td>是</td><td>需要恢复的订单标识，SDK恢复订单回调中包含</td></tr><tr><td>Product_Name</td><td>是</td><td>商品名称，建议以游戏名称开头，方便财务对账</td></tr><tr><td>Product_Id</td><td>是</td><td>商品ID，到AppStore购买的商品</td></tr><tr><td>Product_Price</td><td>是</td><td>商品价格（单位分），对于AppStore支付，该字段没有用处，但是需要传递真实金额，有多处需要用到</td></tr><tr><td>Sid</td><td>是</td><td>所在服务器ID，不能有特殊字符，服务端支付回调会包含该字段</td></tr><tr><td>Role_Id</td><td>否</td><td>支付角色ID，服务端支付回调会包含该字段</td></tr><tr><td>OrderId</td><td>否</td><td>游戏侧订单号，服务端支付回调会包含该字段</td></tr><tr><td>EXT</td><td>否</td><td>额外信息，最长512个字符，服务端支付回调会包含该字段。可用于标记区分充值回调地址，如需使用该功能，请联系平台进行配置。代码示例：[prdInfo setObject:@&quot;{\&quot;payCallbackCode\&quot;:1}&quot; forKey:@&quot;EXT&quot;];</td></tr></tbody></table><p><strong>5.8.3 支付结果</strong></p><p>调用发起支付和恢复支付接口会触发下列回调。</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>支付完成</td><td>- (void)onPayCompleted;</td></tr><tr><td>支付失败</td><td>- (void)onPayFailed:(nullable NSString*)error_msg;</td></tr><tr><td>支付取消</td><td>- (void)onPayCanceled;</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="59登出"></a>5.9.登出<a class="hash-link" href="#59登出" title="Direct link to heading">#</a></h3><p>需要注销当前登录用户时调用，该操作不会出现登录界面。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">logout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>登出成功</td><td>- (void)onLogoutSucceed;</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="510游客升级"></a>5.10.游客升级<a class="hash-link" href="#510游客升级" title="Direct link to heading">#</a></h3><p>调用下列方法可直接调起游客升级界面：
<code>+ (BOOL)openUserBindView;</code></p><p>当游客账号升级成功或失败时,会触发下列回调。<br>
后续如需使用token，务必使用回调给的新token。但已生效的会话无需处理。</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>游客升级成功</td><td>- (void)onGuestBindSucceed:(nonull NSString*)access_token;</td></tr></tbody></table><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>游客升级失败</td><td>- (void)onGuestBindFail:(nonnull NSString*)errorMsg</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="511微信分享"></a><del>5.11.微信分享</del><a class="hash-link" href="#511微信分享" title="Direct link to heading">#</a></h3><span style="color:#f00;padding:0.2rem">注意: 该版本微信分享模块已废弃！！！后续更新版本将彻底移除微信分享，如有相关分享需求请自行对接第三方平台 SDK。</span><p>调用XDWXShare文件中的以下方法，使用微信分享功能。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">WXShareWithObject</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">XDWXShareObject</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">shareObject</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>XDWXShareObject详细参数说明</p><table><thead><tr><th>通用参数</th><th>是否必须</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>text</td><td>否</td><td>NSString</td><td>分享文字内容</td></tr><tr><td>bText</td><td>是</td><td>BOOL</td><td>分享内容是否为多媒体内容（YES文本内容，NO多媒体内容）</td></tr><tr><td>scene</td><td>是</td><td>int</td><td>分享场景（0对话，1朋友圈，2收藏）</td></tr><tr><td>type</td><td>是</td><td>int</td><td>分享类型（0文本，1图片，2音乐，3视频，4网页）</td></tr><tr><td>title</td><td>否</td><td>NSString</td><td>分享标题</td></tr><tr><td>descriptionStr</td><td>否</td><td>NSString</td><td>分享描述信息</td></tr><tr><td>thumbData</td><td>否</td><td>NSData</td><td>缩略图数据</td></tr><tr><td>thumbPath</td><td>否</td><td>NSString</td><td>缩略图路径</td></tr><tr><td>thumbImage</td><td>否</td><td>UIImage</td><td>缩略图对象（优先级thumbImage&gt;thumbPath&gt;thumbData,若都未进行设置，则不显示缩略图）</td></tr><tr><td>meidaTagName</td><td>否</td><td>NSString</td><td></td></tr><tr><td>messageExt</td><td>否</td><td>NSString</td><td></td></tr><tr><td>messageAction</td><td>否</td><td>NSString</td><td></td></tr></tbody></table><p>以下参数，请根据不同的分享类型（type参数）进行设置</p><table><thead><tr><th>图片分享</th><th>是否必须</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>imageData</td><td>否</td><td>NSData</td><td>分享图片数据</td></tr><tr><td>imageUrl</td><td>否</td><td>NSString</td><td>分享图片Url（imageData、imageUrl不可同时为空）</td></tr></tbody></table><table><thead><tr><th>音乐分享</th><th>是否必须</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>musicUrl</td><td>是</td><td>NSString</td><td>音乐链接</td></tr><tr><td>musicLowBandUrl</td><td>否</td><td>NSString</td><td>低带宽音乐链接</td></tr><tr><td>musicDataUrl</td><td>否</td><td>NSString</td><td>音乐数据链接</td></tr><tr><td>musicLowBandDataUrl</td><td>否</td><td>NSString</td><td>低带宽状音乐数据链接</td></tr></tbody></table><table><thead><tr><th>视频分享</th><th>是否必须</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>videoUrl</td><td>是</td><td>NSString</td><td>视频链接</td></tr><tr><td>videoLowBandUrl</td><td>否</td><td>NSString</td><td>低带宽视频链接</td></tr></tbody></table><table><thead><tr><th>网页分享参数</th><th>是否必须</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>webpageUrl</td><td>是</td><td>NSString</td><td>网页链接</td></tr></tbody></table><p>API调用示例
在分享之前，需要设置分享回调</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token macro property">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token macro property"> &lt;XdComPlatform/XDWXShare.h&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">@interface</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">YourCallBack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">&lt;</span><span class="token plain">XDWXShareCallBack</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDWXShare setWXShareCallBack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">YourCallBack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDWXShareObject </span><span class="token operator">*</span><span class="token plain"> obj </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDWXShareObject shareObject</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">obj</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">text </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">obj</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">title </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;title&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">XDWXShare WXShareWithObject</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">obj</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调。</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>分享成功</td><td>- (void)onWXShareSucceed;</td></tr><tr><td>分享失败</td><td>- (void)onWXShareFailed:(nullable NSString*)error_msg;</td></tr></tbody></table><span style="color:#f00;padding:0.2rem">注意: 在进行分享时，若用户选择留在微信，则无法收到分享回调，此处不可以完全依赖上述回调事件。</span><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="512实名认证"></a>5.12.实名认证<a class="hash-link" href="#512实名认证" title="Direct link to heading">#</a></h3><p>在用户登录成功状态下，调用该接口打开实名认证窗口。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/*实名认证*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">openRealName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调。</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>认证成功</td><td>- (void)onRealNameSucceed;</td></tr><tr><td>认证失败</td><td>- (void)onRealNameFailed:(nullable NSString*)error_msg;</td></tr></tbody></table><span style="color:#f00;padding:0.2rem">注意: 用户的实名认证状态以服务端接口（6.1）authoriz_state参数为准。</span><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="513用户反馈"></a>5.13.用户反馈<a class="hash-link" href="#513用户反馈" title="Direct link to heading">#</a></h3><p>在用户登录成功状态下，调用该接口打开实名认证窗口。游客需要先进行实名制。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> 用户反馈</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">userFeedback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="514taptap论坛"></a>5.14.TapTap论坛<a class="hash-link" href="#514taptap论坛" title="Direct link to heading">#</a></h3><p>请先联系XDSDK相关人员申请开通论坛。</p><p>配置info.plist</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSPhotoLibraryUsageDescription&lt;/key&gt;   </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;XXXX需要您的同意,才能访问相册&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;   </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;XXXX需要您的同意,才能访问相机&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;true/&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/dict&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>引入头文件
『#import \&lt;TapTapSDK/TapTapSDK.h&gt;』</p><p>打开论坛</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">//appid 游戏论坛ID，与TapTap开发者ID不同</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">TapTapSDK openTapTapForum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">appid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 指定帖子地址</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">TapTapSDK openTapTapForum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">appid uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSString </span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">u</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="515防沉迷"></a>5.15.防沉迷<a class="hash-link" href="#515防沉迷" title="Direct link to heading">#</a></h3><p>XDSDK集成防沉迷相关功能，支持单机与联网游戏。
防沉迷计时提供开始和关闭接口，游戏可根据需求调用。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/// 恢复时长统计</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">gameResume</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 停止时长统计</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">gameStop</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="516-协议"></a>5.16. 协议<a class="hash-link" href="#516-协议" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/// 打开协议页面</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// @param type 0用户协议， 1游戏协议， 2隐私协议</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">openProtocolWithType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSInteger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 回调 `XDCallback`</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 手动打开协议界面成功</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onOpenProtocolSuccess</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// 手动打开协议界面失败</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">onOpenProtocolFail</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><span style="color:#f00;padding:0.2rem">注意* 当用户点击`仍不同意` 后程序将会退出</span><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="517-打开动态个人中心"></a>5.17. 打开动态个人中心<a class="hash-link" href="#517-打开动态个人中心" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/// 打开用户动态个人中心</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// @param xdId 心动 id</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/// @param config json 字符串固定格式</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">openTapMomentUserCenterWithId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSString </span><span class="token operator">*</span><span class="token plain">_Nonnull</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">xdId config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NSString </span><span class="token operator">*</span><span class="token plain">_Nonnull</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>config</code> 参数配置</p><table><thead><tr><th>默认</th><th>横屏</th><th>竖屏</th></tr></thead><tbody><tr><td>{\&quot;orientation\&quot;:-1}</td><td>{\&quot;orientation\&quot;:0}</td><td>{\&quot;orientation\&quot;:1}</td></tr></tbody></table><span style="color:#f00;padding:0.2rem">注意* 接入`TapMoment.framework` 方可达到预期效果 如需使得动态支持横竖屏需要APP本身支持横竖屏（xcode配置Device Orientation）</span><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="6广告部分说明"></a>6.广告部分说明<a class="hash-link" href="#6广告部分说明" title="Direct link to heading">#</a></h2><p>XDSDK内部集成了部分主要渠道广告SDK，包括今日头条巨量广告平台SDK（TTTracker.framework，版本2.0.6），和腾讯广点通SDK（GDTActionSDK.framework，版本1.4.9）。必要事件（如注册）会在SDK内部发送，充值事件由XDSDK服务端发送事件到相应平台。游戏不用做额外对接工作。</p><p>需要接入相应平台的SDK请联系XDSDK后端配置广告参数。游戏打包时加入对应的SDK即可。</p><p>注意：</p><p>1.广点通SDK在添加到Link Binary With Libraries之后，还必须添加到Embedded Contend中。</p><p>2.build setting 中Other Link Flag 中添加-ObjC。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="7服务端对接"></a>7.服务端对接<a class="hash-link" href="#7服务端对接" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="71获取用户信息"></a>7.1.获取用户信息<a class="hash-link" href="#71获取用户信息" title="Direct link to heading">#</a></h3><p>游戏服务端使用客户端获取的access token，按照下面的方式获取用户信息。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">接口：https</span><span class="token operator">:</span><span class="token comment" style="color:rgb(98, 114, 164)">//api.xd.com/v1/user</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">method：GET</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">参数：access_token</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">请求示例：https</span><span class="token operator">:</span><span class="token comment" style="color:rgb(98, 114, 164)">//api.xd.com/v1/user?access_token=1234</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">成功判断：返回的HTTP Code为</span><span class="token number">200</span><span class="token plain">时表示成功，否则失败</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">返回数据格式：application/json</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">返回值示例：</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;id_card&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1111&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;xdname&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;adult_type&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;friendly_name&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;xdfriendly_name&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abc&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;phone&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;safety&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;site&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">id：用户的ID，注意类型是字符串</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">id_card：加密的身份证号，可能为空</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">name：用户的账号名称</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">adult_type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0.</span><span class="token plain">未实名 </span><span class="token number">1.</span><span class="token plain"> </span><span class="token number">0</span><span class="token number">-8</span><span class="token plain">岁 </span><span class="token number">2.</span><span class="token plain"> </span><span class="token number">8</span><span class="token number">-16</span><span class="token plain">岁 </span><span class="token number">3.</span><span class="token plain"> </span><span class="token number">16</span><span class="token number">-18</span><span class="token plain">岁 </span><span class="token number">4.</span><span class="token plain"> </span><span class="token number">18</span><span class="token plain">+岁</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">friendly_name：用户的昵称，如果游戏想要展现用户名称，建议使用该字段</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">client_id：该用户在该游戏登录时使用的心动AppID</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">phone： 绑定的手机号码</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">safety： 账号是否安全/通过设备二次验证（</span><span class="token boolean">true</span><span class="token plain">：安全，</span><span class="token boolean">false</span><span class="token plain">：不安全）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">site：账号类型</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> =&gt; vc账号，</span><span class="token number">1</span><span class="token plain"> =&gt; 心动账号，</span><span class="token number">3</span><span class="token plain"> =&gt; qq账号，</span><span class="token number">8</span><span class="token plain"> =&gt; 微信账号，</span><span class="token number">9</span><span class="token plain"> =&gt; TapTap账号，</span><span class="token number">10</span><span class="token plain"> =&gt; 苹果账号，注意类型是字符串</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">fcm：</span><span class="token number">0</span><span class="token plain">/</span><span class="token number">1</span><span class="token plain">（</span><span class="token number">0</span><span class="token plain">：无需防沉迷，</span><span class="token number">1</span><span class="token plain">：需要防沉迷）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">authoriz_state：</span><span class="token number">0</span><span class="token plain">/</span><span class="token number">1</span><span class="token plain">/</span><span class="token number">2</span><span class="token plain">/</span><span class="token number">3</span><span class="token plain">/</span><span class="token number">4</span><span class="token plain">（实名状态</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token plain">未实名，&gt;</span><span class="token number">0</span><span class="token plain"> 都表示已实名认证）</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><table><thead><tr><th>应用场景</th><th>参数以及使用方法</th></tr></thead><tbody><tr><td>判断是否游客账号</td><td>游客账号的name和id相同</td></tr><tr><td>判断是否通过二次验证</td><td>safety（0未验证，&gt;0已验证）</td></tr><tr><td>判断账号类型</td><td>site（0 =&gt; vc账号，1 =&gt; 心动账号，3 =&gt; qq账号，8 =&gt; 微信账号，9 =&gt; TapTap账号，注意类型是字符串）</td></tr><tr><td>判断防沉迷状态</td><td>fcm（0：无需防沉迷，1：需要防沉迷）</td></tr><tr><td>判断是否实名认证</td><td>authoriz_state（0未实名，&gt;0 都表示已实名认证）</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="72处理支付回调"></a>7.2.处理支付回调<a class="hash-link" href="#72处理支付回调" title="Direct link to heading">#</a></h3><p>游戏服务端需要提供一个能够处理支付回调的接口，这个接口是申请心动AppID时需要的。处理逻辑中，需要使用一个密钥进行加密验证，该密钥即为心动AppKey。
当心动平台处有充值成功时，心动服务端会通知到支付回调接口，信息如下。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">method：POST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">数据格式：application/x-www-form-urlencoded</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><span style="color:#f00;padding:0.2rem">请勿信任透传参数</span><p>字段如下。</p><table><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>order_id</td><td>number</td><td>心动平台的订单号，相同订单号表示是同一笔支付</td></tr><tr><td>payment</td><td>string</td><td>支付方式，appstore或其它（若回调无该字段，则默认为appstore）</td></tr><tr><td>sub_payment</td><td>string</td><td>子支付方式，Production、Sandbox或其他，为Sandbox表示苹果沙盒充值（值可能为空）</td></tr><tr><td>user_id</td><td>string</td><td>充值用户ID，注意类型是字符串</td></tr><tr><td>client_id</td><td>string</td><td>充值的心动AppID</td></tr><tr><td>app</td><td>string</td><td>同client_id</td></tr><tr><td>app_id</td><td>string</td><td>游戏客户端调用充值时传递的Sid字段</td></tr><tr><td>app_order_id</td><td>string</td><td>游戏客户端调用充值时传递的OrderId字段</td></tr><tr><td>role_id</td><td>string</td><td>游戏客户端调用充值时传递的Role_Id字段</td></tr><tr><td>product_id</td><td>string</td><td>支付购买的商品ID</td></tr><tr><td>gold</td><td>number</td><td>支付实际所付金额，单位元。（仅在客户端使用非AppStore支付方式支付时才有该字段）</td></tr><tr><td>ext</td><td>string</td><td>游戏客户端调用充值时传递的EXT字段</td></tr><tr><td>timestamp</td><td>number</td><td>时间戳，1970年到当前时间的秒数</td></tr><tr><td>sign</td><td>string</td><td>签名校验字段，按照下面的方式进行校验</td></tr></tbody></table><p>签名算法示例，使用php语言。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-objectivec codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @param params 类型array，支付回调时收到的参数</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">* @param appKey 类型string，心动AppKey</span></div><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">function </span><span class="token function" style="color:rgb(80, 250, 123)">verify_sign</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$params</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> $appKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$tmp </span><span class="token operator">=</span><span class="token plain"> $params</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$sign </span><span class="token operator">=</span><span class="token plain"> $tmp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sign&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">unset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$tmp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sign&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ksort</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$tmp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">strcasecmp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$sign</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">md5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">http_build_query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">$tmp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"> $appKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><span style="color:#f00;padding:0.2rem">需要注意<p>1、游戏服务端应该按照order_id进行排重，相同order_id仅生效一次。</p><p>2、游戏服务端成功处理了支付回调后，应当返回字符串“success”，如果是一笔已经处理的重复的订单，也应该返回“success”。</p><p>3、只要通过签名校验的回调，都应该视为合法数据，按照如下逻辑发放道具。A.如果payment字段为appstore，即AppStore支付，直接按照product_id字段进行道具发放；B.如果payment字段为其它值，需要验证gold字段和 product_id 字段是否相符，如果相符，按照product_id发放道具，如果不相符，直接按照gold字段折算成对应的游戏货币发放。</p></span></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/XDSDK-Doc/android"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Android快速开始</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/XDSDK-Doc/fun-db"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TapDB »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1心动sdk介绍" class="table-of-contents__link">1.心动SDK介绍</a><ul><li><a href="#11登录流程" class="table-of-contents__link">1.1.登录流程</a></li><li><a href="#12支付流程" class="table-of-contents__link">1.2.支付流程</a></li><li><a href="#13sdk集成流程" class="table-of-contents__link">1.3.SDK集成流程</a></li></ul></li><li><a href="#2申请心动appid" class="table-of-contents__link">2.申请心动AppID</a></li><li><a href="#3需要遵守的规则" class="table-of-contents__link">3.需要遵守的规则</a><ul><li><a href="#31回调依赖" class="table-of-contents__link">3.1.回调依赖</a></li></ul></li><li><a href="#4接入sdk" class="table-of-contents__link">4.接入SDK</a><ul><li><a href="#41获取sdk" class="table-of-contents__link">4.1.获取SDK</a></li><li><a href="#42添加系统依赖库" class="table-of-contents__link">4.2.添加系统依赖库</a></li><li><a href="#43设置url-types" class="table-of-contents__link">4.3.设置URL Types</a></li><li><a href="#44配置infoplist" class="table-of-contents__link">4.4.配置info.plist</a></li><li><a href="#45配置工程capability" class="table-of-contents__link">4.5.配置工程capability</a></li><li><a href="#46处理第三方应用跳回事件" class="table-of-contents__link">4.6.处理第三方应用跳回事件</a></li></ul></li><li><a href="#5接口调用" class="table-of-contents__link">5.接口调用</a><ul><li><a href="#51配置sdk登录选项" class="table-of-contents__link">5.1.配置SDK登录选项</a></li><li><a href="#52实现sdk协议" class="table-of-contents__link">5.2.实现SDK协议</a></li><li><a href="#53初始化sdk" class="table-of-contents__link">5.3.初始化SDK</a></li><li><a href="#54登录" class="table-of-contents__link">5.4.登录</a></li><li><a href="#55获取access-token" class="table-of-contents__link">5.5.获取Access Token</a></li><li><a href="#56获取当前登录状态" class="table-of-contents__link">5.6.获取当前登录状态</a></li><li><a href="#58发起支付" class="table-of-contents__link">5.8.发起支付</a></li><li><a href="#59登出" class="table-of-contents__link">5.9.登出</a></li><li><a href="#510游客升级" class="table-of-contents__link">5.10.游客升级</a></li><li><a href="#511微信分享" class="table-of-contents__link"><del>5.11.微信分享</del></a></li><li><a href="#512实名认证" class="table-of-contents__link">5.12.实名认证</a></li><li><a href="#513用户反馈" class="table-of-contents__link">5.13.用户反馈</a></li><li><a href="#514taptap论坛" class="table-of-contents__link">5.14.TapTap论坛</a></li><li><a href="#515防沉迷" class="table-of-contents__link">5.15.防沉迷</a></li><li><a href="#516-协议" class="table-of-contents__link">5.16. 协议</a></li><li><a href="#517-打开动态个人中心" class="table-of-contents__link">5.17. 打开动态个人中心</a></li></ul></li><li><a href="#6广告部分说明" class="table-of-contents__link">6.广告部分说明</a></li><li><a href="#7服务端对接" class="table-of-contents__link">7.服务端对接</a><ul><li><a href="#71获取用户信息" class="table-of-contents__link">7.1.获取用户信息</a></li><li><a href="#72处理支付回调" class="table-of-contents__link">7.2.处理支付回调</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/XDSDK-Doc/styles.04ea6341.js"></script>
<script src="/XDSDK-Doc/runtime~main.aa48e010.js"></script>
<script src="/XDSDK-Doc/main.00965467.js"></script>
<script src="/XDSDK-Doc/1.ab684445.js"></script>
<script src="/XDSDK-Doc/2.f8601547.js"></script>
<script src="/XDSDK-Doc/22.95066253.js"></script>
<script src="/XDSDK-Doc/935f2afb.84422a50.js"></script>
<script src="/XDSDK-Doc/17896441.f8f7aa8e.js"></script>
<script src="/XDSDK-Doc/32fcddf3.0cc07d93.js"></script>
</body>
</html>