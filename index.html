<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/XDSDK-Doc/blog/rss.xml" title="XDSDK 文档中心 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/XDSDK-Doc/blog/atom.xml" title="XDSDK 文档中心 Blog Atom Feed"><title data-react-helmet="true">Unity3.x快速开始 | XDSDK 文档中心</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Unity3.x快速开始 | XDSDK 文档中心"><meta data-react-helmet="true" name="description" content="基于XDSDK实现简单的登录功能"><meta data-react-helmet="true" property="og:description" content="基于XDSDK实现简单的登录功能"><meta data-react-helmet="true" property="og:url" content="https://xindong.github.io/XDSDK-Doc/"><link data-react-helmet="true" rel="shortcut icon" href="/XDSDK-Doc/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://xindong.github.io/XDSDK-Doc/"><script data-react-helmet="true">document.addEventListener("DOMContentLoaded",(function(){var n=document.getElementById("base-url-issue-banner-container");if(n){var e=window.location.pathname,t="/"===e.substr(-1)?e:e+"/";n.innerHTML=t}}))</script><link rel="stylesheet" href="/XDSDK-Doc/styles.98143238.css">
<link rel="stylesheet" href="/XDSDK-Doc/main.c62259f1.css">
<link rel="preload" href="/XDSDK-Doc/styles.04ea6341.js" as="script">
<link rel="preload" href="/XDSDK-Doc/runtime~main.2583d833.js" as="script">
<link rel="preload" href="/XDSDK-Doc/main.00965467.js" as="script">
<link rel="preload" href="/XDSDK-Doc/1.ab684445.js" as="script">
<link rel="preload" href="/XDSDK-Doc/2.f8601547.js" as="script">
<link rel="preload" href="/XDSDK-Doc/22.95066253.js" as="script">
<link rel="preload" href="/XDSDK-Doc/935f2afb.84422a50.js" as="script">
<link rel="preload" href="/XDSDK-Doc/17896441.f8f7aa8e.js" as="script">
<link rel="preload" href="/XDSDK-Doc/df7c724d.1dabc689.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div class="baseUrlIssueBanner_1-cE" style="border:solid red thick;background-color:#ffe6b3;margin:20px;padding:20px;font-size:20px"><p style="font-weight:bold;font-size:30px">Your Docusaurus site did not load properly.</p><p>A very common reason is a wrong site <a href="https://v2.docusaurus.io/docs/docusaurus.config.js/#baseurl" style="font-weight:bold">baseUrl configuration</a>.</p><p>Current configured baseUrl = <span style="font-weight:bold;color:red">/XDSDK-Doc/</span> </p><p>We suggest trying baseUrl = <span style="font-weight:bold;color:green" id="base-url-issue-banner-container"></span> </p></div><nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/XDSDK-Doc/"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a><a class="navbar__item navbar__link" href="/XDSDK-Doc/">XDSDK</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/xindong/XDSDK-Doc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/XDSDK-Doc/"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/XDSDK-Doc/img/logo.png" alt="XDSDK" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/XDSDK-Doc/">XDSDK</a></li><li class="menu__list-item"><a href="https://github.com/xindong/XDSDK-Doc" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">接入文档</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XDSDK-Doc/unity2.x">Unity2.x</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/XDSDK-Doc/">Unity3.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XDSDK-Doc/android">Android</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/XDSDK-Doc/ios">iOS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">功能介绍</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/fun-db">TapDB (XDSDK 中使用)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/tap-fun-db">TapDB (单独使用)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/tap-moment">动态 2.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/tap-fun-moment">动态 3.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/XDSDK-Doc/fun-service">服务端</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/XDSDK-Doc/xd-faq">常见问题</a></li><li class="menu__list-item"><a class="menu__link" href="/XDSDK-Doc/xdsdk-changelog">更新日志</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Unity3.x快速开始</h1></header><div class="markdown"><p>基于XDSDK实现简单的登录功能</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="unity-环境设置及-sdk-资源配置"></a>Unity 环境设置及 SDK 资源配置<a class="hash-link" href="#unity-环境设置及-sdk-资源配置" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="前提条件"></a>前提条件<a class="hash-link" href="#前提条件" title="Direct link to heading">#</a></h3><ul><li><p>安装Unity <strong>Unity 2018.3</strong> 或更高版本</p></li><li><p>IOS 编译最低版本为 <strong>10</strong> 或更高版本</p></li><li><p>Android 编译设置 <strong>Minimum API 21</strong> 或更高版本, Target API 建议使用 30 以下</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-添加-xdsdk-依赖"></a>1. 添加 XDSDK 依赖<a class="hash-link" href="#1-添加-xdsdk-依赖" title="Direct link to heading">#</a></h3><p><strong>已接入旧版 SDK 的游戏需要先删除旧版 SDK 的所有文件，具体文件列表参考 <a href="/XDSDK-Doc/old-list">旧版SDK文件列表</a></strong>  </p><p> 新版 XDSDK 使用 UPM 方式导入 SDK 资源，配置方式有两种，选择一种即可，如下所示：</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="11-修改对应配置文件"></a>1.1 修改对应配置文件<a class="hash-link" href="#11-修改对应配置文件" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">//在YourProjectPath/Packages/manifest.json中添加以下代码</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;com.xd.sdk&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://github.com/xindong/XDSDK_UPM.git#3.3.0&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;com.tds.sdk&quot;</span><span class="token operator">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://github.com/xindong/TAPSDK_UPM.git#1.1.6&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="12-通过-unity-packagemanager-导入"></a>1.2 通过 Unity PackageManager 导入<a class="hash-link" href="#12-通过-unity-packagemanager-导入" title="Direct link to heading">#</a></h4><p>在 Unity 菜单栏中选择 Window -&gt; Package Manager, 选择添加方式为 <code>Add package from git URL</code> , 在地址栏中输入 <code>https://github.com/xindong/TAPSDK_UPM.git#1.1.6</code> 和 <code>https://github.com/xindong/XDSDK_UPM.git#3.3.0</code>即可。</p><blockquote><p>注意：不同 Unity 版本 UI 显示可能略有差别</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-配置-xdsdk"></a>2. 配置 XDSDK<a class="hash-link" href="#2-配置-xdsdk" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="21-android-配置"></a>2.1 Android 配置<a class="hash-link" href="#21-android-配置" title="Direct link to heading">#</a></h4><p>编辑 Assets/Plugins/Android/AndroidManifest.xml 文件, 样例如下。</p><blockquote><p><strong>注意：游戏需要将<code>包名</code> 字段改为游戏的包名</strong></p></blockquote><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-xml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">manifest</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">xmlns:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">android</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">http://schemas.android.com/apk/res/android</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">  </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">xmlns:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">tools</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">http://schemas.android.com/tools</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">    </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">package</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">com.xd.sdklib</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">    </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">versionCode</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">1</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">    </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">versionName</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">1.0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">uses-sdk</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">tools:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">overrideLibrary</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">com.bun.miitmdid</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">uses-permission</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">android.permission.INTERNET</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">uses-permission</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">android.permission.ACCESS_NETWORK_STATE</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">uses-permission</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">android.permission.ACCESS_WIFI_STATE</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">uses-permission</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">android.permission.WRITE_EXTERNAL_STORAGE</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">application</span><span class="token tag" style="color:rgb(255, 121, 198)">  </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">usesCleartextTraffic</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">true</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">activity</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                         </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">com.unity3d.player.UnityPlayerActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                         </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">launchMode</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">2</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                         </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">screenOrientation</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                         </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">configChanges</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">orientation|keyboardHidden|screenSize</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                         </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">hardwareAccelerated</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">false</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                         </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">intent-filter</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                             </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">action</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                                 </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">android.intent.action.MAIN</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                             </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">category</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">                                 </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">android.intent.category.LAUNCHER</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                         </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">intent-filter</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">activity</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- 微信登录 --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">activity-alias</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">包名.wxapi.WXEntryActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">exported</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">true</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">targetActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">com.xd.sdklib.helper.WXEntryActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- 微信支付 --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">activity-alias</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">包名.wxapi.WXPayEntryActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">exported</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">true</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">android:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">targetActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">com.pingplusplus.android.PaymentActivity</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">application</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">manifest</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="22-ios-配置"></a>2.2 IOS 配置<a class="hash-link" href="#22-ios-配置" title="Direct link to heading">#</a></h4><p>在 Assets / Plugins / iOS / Resource 目录下创建 XD-Info.plist 文件,复制以下代码并且替换其中以下内容。</p><blockquote><p>注意：目录名要区分大小写</p></blockquote><ul><li>wechat：微信 ClientId</li><li>tecent：腾讯 ClientId</li><li>XD：XD ClientId</li><li>Apple_SignIn_Enable：true 需要Apple登陆</li><li>Game_Domain：applinks</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-xml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token prolog" style="color:rgb(189, 147, 249)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token doctype">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">plist</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">version</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">1.0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">wechat</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">client_id</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">wxbdfbe5dbd3e3c64b</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">tencent</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">client_id</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">tencent1106148555</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">XD</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">client_id</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">XD-d4bjgwom9zk84wk</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Apple_SignIn_Enable</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Game_Domain</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">key</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">string</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dict</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">plist</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>在 Assets / Plugins / iOS / Resource 目录下创建 TDS-Info.plist 文件，复制以下代码并且替换其中的 TapTap 的 ClientId 和 授权文案</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;plist version=&quot;1.0&quot;&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;key&gt;taptap&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;key&gt;client_id&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;string&gt;ClientId&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;/dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;key&gt;NSPhotoLibraryUsageDescription&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;string&gt;App 需要你的同意，才能访问相册 &lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;key&gt;NSCameraUsageDescription&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;string&gt;App 需要你的同意，才能访问相机 &lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;key&gt;NSMicrophoneUsageDescription&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;string&gt;App 需要你的同意，才能访问麦克风 &lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;key&gt;NSUserTrackingUsageDescription&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;string&gt;请允许xxx获取并使用您的IDFA,来为您提供更好的服务&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/plist&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="api"></a>API<a class="hash-link" href="#api" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-实现并设置回调方法"></a>1. 实现并设置回调方法<a class="hash-link" href="#1-实现并设置回调方法" title="Direct link to heading">#</a></h3><p> 脚本需要实现的回调请参考以下代码： </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public class XDSDKHandler : XDCallback {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //初始化成功回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnInitSucceed (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //初始化失败回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnInitFailed (string msg){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //登录成功回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnLoginSucceed (string token){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //登录失败回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnLoginFailed (string msg){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //登录取消回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnLoginCanceled (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //游客绑定成功回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnGuestBindSucceed (string token){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //游客绑定失败回调（可选）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnGuestBindFailed(string msg){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //登出回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnLogoutSucceed (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //支付完成回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnPayCompleted (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //支付失败回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnPayFailed (string msg){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //支付取消回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnPayCanceled (){  </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //Android 退出回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnExitConfirm (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //Android 取消退出回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnExitCancel (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //微信分享成功回调（可选）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnWXShareSucceed (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //微信分享失败回调（可选）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnWXShareFailed (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //实名认证成功</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnRealNameSucceed (){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //实名认证失败</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnRealNameFailed (string error_msg){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// 有未完成的订单回调，比如：礼包码.注意：多个未完成订单会在一个数组中一起回调。（只会在登录状态下回调）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// @param resultList 订单信息List。</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// 单个未完成订单信息包含：     TransactionIdentifier ：订单标识 ，恢复购买时需要回传</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">///                                      Product_Id ：商品ID，</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">///                                        Quantity：商品数量</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public override void RestoredPayment(List&lt;Dictionary&lt;string,string&gt;&gt; resultList){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //用户同意所有协议</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnProtocolAgreed() {}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //打开协议成功</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnProtocolOpenSucceed() {}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //打开协议失败</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnProtocolOpenFailed(string msg) {}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //非游客匿名账号绑定 Tap 账号成功回调（游客会返回升级成功回调）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //返回 msg 为对应 tap 信息, 包括 name,openid,unionid,avatar 字段</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnBindTaptapSucceed(Dictionary&lt;string,string&gt; msg) {}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>设置回调方法 </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.SetCallback (new XDSDKHandler ());</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-配置登录选项"></a>2. 配置登录选项<a class="hash-link" href="#2-配置登录选项" title="Direct link to heading">#</a></h3><p><strong>如果游戏之前登录入口已包含 心动 或 QQ 、微信等其他的账号类型，则使用<code>自定义登录顺序</code>设置，否则使用<code>自定义登录入口</code>。</strong></p><p>建议一般在调用 SDK 初始化前进行登录入口设置。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="21-自定义登录顺序"></a>2.1 自定义登录顺序<a class="hash-link" href="#21-自定义登录顺序" title="Direct link to heading">#</a></h4><p>自定义登录入口。共五种，其中主要两种，次要两种。
默认显示为：</p><p>iOS: 微信、QQ、游客、苹果、TapTap</p><p>安卓: 微信、TapTap、游客、苹果、QQ  </p><p>各登录方式对应名称如下：</p><ul><li>微信登录：WX_LOGIN，</li><li>taptap登录：TAPTAP_LOGIN，</li><li>QQ登录：QQ_LOGIN，</li><li>游客登录：GUEST_LOGIN，</li><li>心动登录：XD_LOGIN</li><li>苹果登录：APPLE_LOGIN</li></ul><p><strong><em>由于苹果审核要求，iOS13 显示第三方登录的同时必须显示苹果登录(建议位置靠前)</em></strong></p><p><strong><em>SDK 在iOS12及以下、安卓中使用web实现苹果登录，但是若游戏iOS版未上架appstore，无法使用web版苹果登录，游戏需在iOS应用上架之后，才打开iOS12系统及以下和安卓的苹果登录入口。</em></strong></p><p>例如传入的数组 {&quot;APPLE_LOGIN&quot;,&quot;WX_LOGIN&quot;,&quot;TAPTAP_LOGIN&quot;,&quot;GUEST_LOGIN&quot;,&quot;QQ_LOGIN&quot;}  </p><blockquote><p>注：(1) 最多只能显示5种登录方式。(2) 5个登录按钮中 TapTap 和心动登录不能同时显示</p></blockquote><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 自定义登录按钮及顺序</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.SetLoginEntries({&quot;APPLE_LOGIN&quot;,&quot;WX_LOGIN&quot;,&quot;TAPTAP_LOGIN&quot;,&quot;GUEST_LOGIN&quot;,&quot;QQ_LOGIN&quot;});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="22-自定义登录入口"></a>2.2 自定义登录入口<a class="hash-link" href="#22-自定义登录入口" title="Direct link to heading">#</a></h4><p>登录入口 UI 由游戏绘制，不再使用 SDK 页面。绘制登录按钮所需要的 UI 素材由 SDK 提供，素材地址：<a target="_blank" href="/XDSDK-Doc/assets/files/XDSDK登录方式(大陆)_2020-5bf64eac3ad26076cd7c60feaf667289.zip">XDSDK登录方式素材</a>  </p><p>使用该方式登录时, SDK 提供了对应的自定义登录接口（iOS:AutoLogin/TapTapLogin/AppleLogin/GuestLogin,Android:AutoLogin/TapTapLogin），用户在点击游戏绘制的登录入口后，游戏调用对应登录接口即可。  </p><p><strong>登录调用方法 ：</strong> 游戏首先隐藏登录入口，调用 AutoLogin，根据登录回调看是否自动登录成功。如果自动登录失败，其中回调信息为『自动登录失败』，则显示登录界面，然后根据用户点击不同登录按钮调用对应登录接口如 TapTapLogin 等。</p><p><strong>（在使用自定义绘制按钮登录时，如果用户因防沉迷而点击切换账号按钮时，会返回登录取消的回调）</strong></p><p>自定义登录接口如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 自动登录（若有上次登录记录，则会直接登录）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static bool AutoLogin() </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// TapTap登录</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void TapTapLogin() </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 苹果登录</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void AppleLogin() </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 游客登录</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void GuestLogin() </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例：</p><p><img src="/XDSDK-Doc/assets/images/5-f16c368243c65551011faef60778166f.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3-初始化sdk"></a>3. 初始化SDK<a class="hash-link" href="#3-初始化sdk" title="Direct link to heading">#</a></h3><p>初始化心动SDK应尽量提前，调用该接口是调用其它功能接口的必要条件。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param appid 心动AppID</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param aOrientation 屏幕方向，0表示横屏，1表示竖屏</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param channel 渠道号</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param version 版本号</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param enableTapDB 是否开启TapDB</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param enableMoment 是否使用动态</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void InitSDK(string appid, int aOrientation, string channel, string version, bool enableTapDB, bool enableMoment)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例代码：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.InitSDK (&quot;xxxxxx&quot;, 1, &quot;xx&quot;, &quot;xx&quot;, true, true);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调。</p><blockquote><p><strong><em>其他接口请在获取到初始化成功回调之后进行调用。</em></strong></p></blockquote><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>初始化成功</td><td>public void OnInitSucceed()</td></tr><tr><td>初始化失败</td><td>public void OnInitFailed(string msg)</td></tr><tr><td>用户同意协议</td><td>public void OnProtocolAgreed()</td></tr></tbody></table><blockquote><p>注意：</p><p>已经单独接入TapDB的项目请勿开启内置TapDB统计功能
其他注意事项请参考文档TapDB部分或与平台联系</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4-登录"></a>4. 登录<a class="hash-link" href="#4-登录" title="Direct link to heading">#</a></h3><blockquote><p>注意：<strong>游戏应在收到同意协议的回调（OnProtocolAgreed）之后再进行登录操作</strong>  </p></blockquote><p>如果游戏使用 <strong>自定义登录顺序</strong> 来配置登录入口，即使用 SDK 登录页，登录时调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void Login()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.Login();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调。</p><p><strong><em>获取、查看用户信息以及支付接口请在获取到登录成功回调之后调用。</em></strong></p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>登录成功</td><td>void OnLoginSucceed(string token)</td></tr><tr><td>登录失败</td><td>void OnLoginFailed(string msg)</td></tr><tr><td>登录取消</td><td>void OnLoginCanceled()</td></tr></tbody></table><p>如果游戏使用 <strong>自定义登录入口</strong> 配置登录入口，即游戏自己绘制登录入口 UI，请参考<a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%99%BB%E5%BD%95%E5%85%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E6%96%B9%E5%BC%8F">自定义登录入口调用方式</a>  ，调用后收到的回调与上述相同。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="41-获取当前登录状态"></a>4.1 获取当前登录状态<a class="hash-link" href="#41-获取当前登录状态" title="Direct link to heading">#</a></h4><p>游戏需要判断当前用户是否登录成功时，调用该接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static bool IsLoggedIn()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>代码示例</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.IsLoggedIn()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="42-获取-accesstoken"></a>4.2 获取 AccessToken<a class="hash-link" href="#42-获取-accesstoken" title="Direct link to heading">#</a></h4><p>用户 <strong>登录成功</strong> 后，如果游戏需要获取当前用户的登录 token ，可调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static string GetAccessToken()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>代码示例</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.GetAccessToken()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="5-角色信息"></a>5. 角色信息<a class="hash-link" href="#5-角色信息" title="Direct link to heading">#</a></h3><p>如果游戏使用 <strong>自定义登录顺序</strong> 来配置登录入口，该设置可跳过。<br>
对于使用 <strong>自定义登录入口</strong> 的游戏，为了在用户中心显示当前用户的角色信息，可调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">//角色登录成功之后，设置当前角色信息；角色登出后，清空当前角色信息</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void SetRole(string roleId, string roleName, string roleAvatar)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public static void ClearRole()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="6-用户中心"></a>6. 用户中心<a class="hash-link" href="#6-用户中心" title="Direct link to heading">#</a></h3><p>调用该接口打开用户中心界面，用户可以在该界面进行游客升级和登出操作，游戏注意正确处理回调。在未登录状态，无法打开用户中心。<br>
在用户中心中，用户可进行登出操作，此时交互界面将消失。游戏需要提供引导用户重新进行登录的操作界面。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">* @return false表示尚未登录，重复调用默认为成功</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static bool OpenUserCenter()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>代码示例</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.OpenUserCenter()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="7-支付"></a>7. 支付<a class="hash-link" href="#7-支付" title="Direct link to heading">#</a></h3><blockquote><p>注意： <strong><em>SDK 不保证在任何情况下都能收到准确回调，请勿直接使用SDK返回的支付结果作为最终判定订单状态的依据，以后端通知结果为准。</em></strong></p></blockquote><p>为了收到支付回调，IOS 需要在应用启动后就设置好支付相关功能。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">- (BOOL)application:(UIApplication*)application didFinishLaunchingWithOptions:(NSDictionary*)launchOptions</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    // 初始化支付</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    [XDCore setupXDStore];</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="71-发起支付"></a>7.1 发起支付<a class="hash-link" href="#71-发起支付" title="Direct link to heading">#</a></h4><p>调用该接口发起支付。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">* @param info 支付相关信息，注意key和value都是字符串类型</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static bool Pay(Dictionary&lt;string, string&gt; info)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其中info的字段如下。</p><table><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>Product_Name</td><td>是</td><td>商品名称，建议以游戏名称开头，方便财务对账</td></tr><tr><td>Product_Id</td><td>是</td><td>商品ID</td></tr><tr><td>Product_Price</td><td>是</td><td>商品价格（单位分）</td></tr><tr><td>Sid</td><td>是</td><td>所在服务器ID，不能有特殊字符，服务端支付回调会包含该字段</td></tr><tr><td>Role_Id</td><td>是</td><td>支付角色ID，服务端支付回调会包含该字段</td></tr><tr><td>OrderId</td><td>否</td><td>游戏侧订单号，服务端支付回调会包含该字段</td></tr><tr><td>EXT</td><td>否</td><td>额外信息，最长512个字符，服务端支付回调会包含该字段。可用于标记区分充值回调地址，如需使用该功能，请联系平台进行配置。代码示例：info.Add(&quot;EXT&quot;, &quot;{\&quot;payCallbackCode\&quot;:2}&quot;);</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="72-恢复支付（-仅-ios-）"></a>7.2 恢复支付（ 仅 IOS ）<a class="hash-link" href="#72-恢复支付（-仅-ios-）" title="Direct link to heading">#</a></h4><p>如果之前发生掉单情况，当玩家再次打开游戏，SDK 会再次向苹果请求一次收据信息。如有掉单的收据，且玩家登录成功后，则通知游戏，游戏来收到通知后来决定是否要补发道具。</p><p><strong><em>游戏内购流程图</em></strong>：</p><p><img src="/XDSDK-Doc/assets/images/3-464186a03f3475216d647ffb244ae726.png"></p><blockquote><p><strong><em>注意: 如果有遗留未完成订单，在接收到恢复订单回调后，(若单个用户可能拥有多个账号，可以请求用户确认后）调用恢复订单接口。</em></strong></p></blockquote><p>说明：</p><p>在掉单的情况下，SDK只能获取订单的基本信息，如商品ID、苹果侧订单ID（非游戏生成order_id）和商品数量，不能直接对应到用户，所以无法直接兑换商品。</p><p>游戏在收到掉单回调之后，可以弹窗请用户确认是否需要恢复商品，如需要，则用回调提供的已有参数，加上其他需要的参数，如角色ID，服务器ID等，使用恢复订单接口恢复该商品。</p><p><strong><em>SDK会提供测试包，供游戏使用沙盒测试（购买之后会造成掉单），游戏调用恢复接口如果成功到账则为测试成功。</em></strong></p><p>游戏内弹窗示例(文案做相应修改)：</p><p><img src="/XDSDK-Doc/assets/images/4-17c357a11358a9a2c8f559e875c9b6e6.jpg"></p><p>回调方法</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// 有未完成的订单回调，比如：礼包码.注意：多个未完成订单会在一个数组中一起回调。（只会在登录状态下回调）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// @param resultList 订单信息List。</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">/// 单个未完成订单信息包含：     TransactionIdentifier ：订单标识 ，恢复购买时需要回传 </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">///                                    Product_Id ：商品ID，</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">///                                        Quantity：商品数量</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public override void RestoredPayment(List&lt;Dictionary&lt;string,string&gt;&gt; resultList){</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>恢复订单接口</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">* @param info 支付相关信息，注意key和value都是字符串类型</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static bool RestorePay(Dictionary&lt;string, string&gt; info)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其中info的字段如下。</p><table><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>TransactionIdentifier</td><td>是</td><td>需要恢复的订单标识，SDK恢复订单回调中包含</td></tr><tr><td>Product_Name</td><td>是</td><td>商品名称，建议以游戏名称开头，方便财务对账</td></tr><tr><td>Product_Id</td><td>是</td><td>商品ID，到AppStore购买的商品</td></tr><tr><td>Product_Price</td><td>是</td><td>商品价格（单位分），对于AppStore支付，该字段没有用处，但是需要传递真实金额，有多处需要用到</td></tr><tr><td>Sid</td><td>是</td><td>所在服务器ID，不能有特殊字符，服务端支付回调会包含该字段</td></tr><tr><td>Role_Id</td><td>是</td><td>支付角色ID，服务端支付回调会包含该字段</td></tr><tr><td>OrderId</td><td>否</td><td>游戏侧订单号，服务端支付回调会包含该字段</td></tr><tr><td>EXT</td><td>否</td><td>额外信息，最长512个字符，服务端支付回调会包含该字段。可用于标记区分充值回调地址，如需使用该功能，请联系平台进行配置。代码示例：[prdInfo setObject:@&quot;{\&quot;payCallbackCode\&quot;:1}&quot; forKey:@&quot;EXT&quot;];</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="73-支付结果"></a>7.3 支付结果<a class="hash-link" href="#73-支付结果" title="Direct link to heading">#</a></h4><p>调用发起支付和恢复支付接口会触发下列回调。</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>支付完成</td><td>public void OnPayCompleted()</td></tr><tr><td>支付失败</td><td>public void OnPayFailed(string msg)</td></tr><tr><td>支付取消</td><td>public void OnPayCanceled()</td></tr></tbody></table><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">Dictionary&lt;string, string&gt; info = new Dictionary&lt;string,string&gt;();</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;OrderId&quot;, &quot;1234567890123456789012345678901234567890&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;Product_Price&quot;, &quot;1&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;EXT&quot;, &quot;abcd|efgh|1234|5678&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;Sid&quot;, &quot;2&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;Role_Id&quot;, &quot;3&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;Product_Id&quot;, &quot;4&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;Product_Name&quot;, &quot;648大礼包&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">info.Add(&quot;EXT&quot;, &quot;{\&quot;payCallbackCode\&quot;:2}&quot;);（）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.Pay (info);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="8-登出"></a>8. 登出<a class="hash-link" href="#8-登出" title="Direct link to heading">#</a></h3><p>需要注销当前登录用户时调用，该操作不会出现登录界面。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void Logout() </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>登出成功</td><td>public void OnLogoutSucceed()</td></tr></tbody></table><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.Logout();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="9-游客升级"></a>9. 游客升级<a class="hash-link" href="#9-游客升级" title="Direct link to heading">#</a></h3><p><strong>如果游戏只有 Tap 登录入口，该接口可忽略。</strong><br>
当游客账号升级成功时,会触发下列回调。<br>
后续如需使用token，务必使用回调给的新token。但已生效的会话无需处理。</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>游客升级成功</td><td>public void OnGuestBindSucceed(string token)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="10-实名认证"></a>10. 实名认证<a class="hash-link" href="#10-实名认证" title="Direct link to heading">#</a></h3><p>当用户为未实名玩家是，调用该方法弹出实名认证窗口。对于已实名用户，调用该接口会返回实名失败。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void OpenRealName()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.OpenRealName();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>确认退出</td><td>public void OnRealNameSucceed()</td></tr><tr><td>取消退出</td><td>public void OnRealNameFailed(string error_msg)</td></tr></tbody></table><blockquote><p>注意：实名认证结果以服务端authoriz_state参数为准（见4.1）。</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="11-游客升级"></a>11. 游客升级<a class="hash-link" href="#11-游客升级" title="Direct link to heading">#</a></h3><p>对于游客账号，如果需要绑定 Tap 或其他类型账号时（根据游戏登录入口决定），调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void OpenUserBindView()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.OpenUserBindView ();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>调用该接口会触发下列回调</p><table><thead><tr><th>类别</th><th>回调方法</th></tr></thead><tbody><tr><td>成功</td><td>public void OnGuestBindSucceed (string token)</td></tr><tr><td>失败</td><td>public void OnGuestBindFailed(string msg)</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="12-客服"></a>12. 客服<a class="hash-link" href="#12-客服" title="Direct link to heading">#</a></h3><p>需要展示客服窗口时调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void UserFeedback()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.UserFeedback();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="13-tapdb"></a>13. TapDB<a class="hash-link" href="#13-tapdb" title="Direct link to heading">#</a></h3><p>如果需要调用 TapDB 中设置等级和服务端地址，可调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void SetLevel(int level)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void SetServer(string server)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例代码</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.SetLevel(100);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">XDSDK.SetServer(&quot;xxxxxxx&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><blockquote><p>注意：
1.新版本SDK中，已经集成了TapDB的onStart、setUser方法，游戏客户端不需要再重复集成。
2.提供了setLevel，setServer方法供游戏调用，充值统计由服务端完成。
3.已接入TapDB的游戏在集成SDK时仅需要移除onStart和setUser方法，其余保持不变。
4.尚未接入TapDB的游戏，可根据需要自行接入SDK中尚未包含的TapDB SDK的其他方法。
5.如果需要自行接入TapDB，请在SDK初始化方法中enableTapDB参数填写false。</p></blockquote><p>为统计数据更加精确，SDK 提供了一个可选的第三方库<code>数美</code>，如果游戏需要数美的设备数据，可以下载依赖库 <a href="https://res.xdcdn.net/tapdb/Android/xdwl/xdwl-pri1-release.aar" target="_blank" rel="noopener noreferrer">数美</a> 并将其添加到项目中。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="14-防沉迷设置"></a>14. 防沉迷设置<a class="hash-link" href="#14-防沉迷设置" title="Direct link to heading">#</a></h3><p>SDK 中提供停止计时和恢复计时接口。游戏根据需求自行调用。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void GameStop();</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static void GameResume ();</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Android 防沉迷和部分统计数据依赖于 XDSDK.OnResume 和 XDSDK.OnStop 接口，所以游戏应确保这两个接口接入正常，在 unity 中接入示例：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">void OnApplicationPause(bool pauseStatus)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        if (pauseStatus)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            xdsdk.XDSDK.OnStop();</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        else</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            xdsdk.XDSDK.OnResume();</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="15-taptap-论坛"></a>15. TapTap 论坛<a class="hash-link" href="#15-taptap-论坛" title="Direct link to heading">#</a></h3><p><strong><em>注意：如果游戏之前未接入 Tap 论坛， 现 Tap 论坛已不再提供新游戏的接入和维护，游戏需使用动态 SDK</em></strong></p><p>如果游戏使用 Tap 内部论坛，需在脚本类中导入 <code>namespace com.taptap.sdk</code>，相关功能接口如下</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">//设置回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void SetCallback(TapForumCallback callback)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//打开论坛, 其中 appid 游戏论坛ID，与TapTap开发者ID不同</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void OpenTapTapForum(string appid)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">TapForumSDK.Instance.SetCallback(new TapforumCallbackExample());</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">TapForumSDK.Instance.OpenTapTapForum(&quot;58001&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">class TapforumCallbackExample : TapForumCallback</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        public override void OnForumAppear()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            Debug.Log(&quot; XDForum open==========&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        public override void OnForumDisappear()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            Debug.Log(&quot; XDForum close==========&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其中 IOS 还需配置 info.plist，内容如下： </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSPhotoLibraryUsageDescription&lt;/key&gt;   </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;XXXX需要您的同意,才能访问相册&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;   </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;XXXX需要您的同意,才能访问相机&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;true/&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/dict&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="16-xdlive-直播"></a>16. XDLive 直播<a class="hash-link" href="#16-xdlive-直播" title="Direct link to heading">#</a></h3><p>XDSDK 中包含了游戏直播相关组件，游戏第一次使用需要联系平台相关人员开通，获取 appid 和授权直播源管理后台。相关接口如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">//设置回调监听</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void SetCallback(XDLiveCallback callback);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//打开论坛, appid: 申请到的appid</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void OpenXDLive(string appid);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//打开论坛，并跳转到指定页  appid: 申请到的appid ,uri: 自定义地址</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void OpenXDLive(string appid,string uri);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//打开论坛，并跳转到指定屏幕方向的指定页  appid: 申请到的appid ,uri: 自定义地址，orientation: 指定屏幕方向（支持竖屏游戏强制设置横屏）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public void OpenXDLive(string appid,string uri,int orientation);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>示例：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">com.xdsdk.xdlive.XDLive.Instance.SetCallback(new XDLIVECallbackE());</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">com.xdsdk.xdlive.XDLive.Instance.OpenXDLive(&quot;123&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">class XDLIVECallbackE : com.xdsdk.xdlive.XDLive.XDLiveCallback</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        override</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        public void OnXDLiveClosed()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            Debug.Log(&quot; xdlive close=========&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        override</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        public void OnXDLiveOpen()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">            Debug.Log(&quot; xdlive open==========&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="17-打开协议页面"></a>17. 打开协议页面<a class="hash-link" href="#17-打开协议页面" title="Direct link to heading">#</a></h3><p>游戏需要打开协议的内容时，可以调用该接口，示例如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">xdsdk.XDSDK.OpenProtocol(xdsdk.XDSDK.ProtocolType.PROTOCOL_TYPE_GAME);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>参数为协议类型，包括  PROTOCOL_TYPE_USER(用户协议),PROTOCOL_TYPE_GAME(游戏协议),PROTOCOL_TYPE_PRIVACY(隐私协议)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="18-地区判断"></a>18. 地区判断<a class="hash-link" href="#18-地区判断" title="Direct link to heading">#</a></h3><p>如果需要判断当前地区是否在大陆内，可调用如下接口：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-c# codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">using TDSCommon;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">TDSCommon.TDSCommon.GetRegionCode((isMainland)=&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    //true 大陆 false 非大陆</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">});</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="19-排队限流"></a>19. 排队限流<a class="hash-link" href="#19-排队限流" title="Direct link to heading">#</a></h3><p>为避免特殊时间段流量高峰，使用排队相关接口可在玩家正式登录并进入游戏前进行控制。相关接入如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">//设置回调</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">com.xdsdk.xdtrafficcontrol.XDTrafficControl.Instance.SetCallback（XDTrafficControlCallback callback);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">//排队检查</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">com.xdsdk.xdtrafficcontrol.XDTrafficControl.Instance.Check(string appid);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>其中 appId 为游戏应用 ID , 示例如下：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">com.xdsdk.xdtrafficcontrol.XDTrafficControl.Instance.SetCallback(new XDTCHandler());</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">com.xdsdk.xdtrafficcontrol.XDTrafficControl.Instance.Check(&quot;appidstring&quot;);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public class XDTCHandler : com.xdsdk.xdtrafficcontrol.XDTrafficControl.XDTrafficControlCallback</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public XDTCHandler()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnQueueingFinished()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">             </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnQueueingFailed(string msg)</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">          </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    public override void OnQueueingCanceled()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>由于排队依赖原生资源文件，所以需要按照 <a target="_blank" href="/XDSDK-Doc/assets/files/trafficControl-1f37f465771496a184aab291c95e8af1.zip">排队限流SDK依赖资源</a> 对应文档将资源文件放到指定目录下。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="原生平台设置"></a>原生平台设置<a class="hash-link" href="#原生平台设置" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-android-平台设置"></a>1. Android 平台设置<a class="hash-link" href="#1-android-平台设置" title="Direct link to heading">#</a></h3><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="11-android-11-适配"></a>1.1 Android 11 适配<a class="hash-link" href="#11-android-11-适配" title="Direct link to heading">#</a></h3><p>游戏打包时根据 targetSdkVersion 版本不同需要进行适配。  </p><blockquote><p>targetSdkVersion 指在 unity 中通过 File -&gt; Build Settings -&gt; Player Settings -&gt; Other Settings 中 Target API Level 设置的版本  </p></blockquote><p>如果游戏打包配置时 targetSdkVersion &lt; 30 , 暂不需要配置，可跳过。<br>
如果 targetSdkVersion &gt;= 30 , 需按如下步骤进行配置：</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-添加-androidmanifest-配置"></a>(1) 添加 AndroidManifest 配置<a class="hash-link" href="#1-添加-androidmanifest-配置" title="Direct link to heading">#</a></h4><p> 在 AndroidManifest.xml 中添加如下内容：</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;manifest ...&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> &lt;queries&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       &lt;package android:name=&quot;com.tencent.mm&quot; /&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       &lt;package android:name=&quot;com.tencent.mobileqq&quot;/&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       &lt;package android:name=&quot;com.taptap&quot; /&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       &lt;package android:name=&quot;com.taptap.pad&quot; /&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">       &lt;package android:name=&quot;com.taptap.global&quot; /&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/queries&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> &lt;!-- 如果游戏需要游客登录或访问非游戏的其他目录文件，则需添加如下权限 --&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;!-- &lt;uses-permission android:name=&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;/&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/manifest&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-unity-配置修改"></a>(2) Unity 配置修改<a class="hash-link" href="#2-unity-配置修改" title="Direct link to heading">#</a></h4><p>根据不同 Unity 版本修改对应编译配置，具体可参考<a href="https://developers.google.com/ar/develop/unity/android-11-build" target="_blank" rel="noopener noreferrer">Unity 适配 Android 11</a>。  </p><p>如果当前版本小于 2019.3.patch 7, 当编译提示 launcher 与 main library 的 gradle 版本不一致错误信息时，需要将 SDK 目录中的 Android 附加 / Android 11适配目录 中 launcherTemplate.gradle 文件复制到项目 Assets / plugins / Android 目录中 、GradleTemplateFixer.cs 复制到 Assets / Editor 目录中。在编译前需选择Unity菜单 Tools -&gt; Build -&gt; Gradle Template Fix (Preprocess build）。如果游戏除了当前项目外还需要编译其他项目，在编译完成后还需选择 Tools -&gt; Build -&gt; Gradle Template Fix (Postprocess build）否则不需要其他操作。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-ios-平台设置"></a>2. iOS 平台设置<a class="hash-link" href="#2-ios-平台设置" title="Direct link to heading">#</a></h3><p>Unity 导出 Xcode 工程时，<strong>如下相关配置已通过脚本自动设置，但不同版本导出时可能会有差别，实际内容以下方配置内容为准，如果因配置不同导致编译运行异常，请参照对应配置修改</strong>。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="21-导入sdk文件"></a>2.1 导入SDK文件<a class="hash-link" href="#21-导入sdk文件" title="Direct link to heading">#</a></h4><p>从心动平台处获取SDK资源文件，其中主要的文件或目录用途如下。</p><table><thead><tr><th>目录或文件</th><th>用途</th></tr></thead><tbody><tr><td>XDSDKResource.bundle</td><td>心动SDK需要或依赖的资源文件，需要保证所有文件都被添加到了Xcode的“Copy Bundle Resources”中</td></tr></tbody></table><p>将以上文件导入Xcode工程。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="22-添加系统依赖库"></a>2.2 添加系统依赖库<a class="hash-link" href="#22-添加系统依赖库" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">libz.tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libsqlite3.0.tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libicucore.tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">*请核对下列库文件是否已自动添加*</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Security.framework </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CFNetwork.framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">UIKit.framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">QuartzCore.framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">Foundation.framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CoreGraphics.Framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">CoreTelephony.framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">SystemConfiguration.framework</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libiconv.tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">libc++.tbd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 2.1.0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">AuthenticationServices.framework</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="23-设置-url-types"></a>2.3 设置 URL Types<a class="hash-link" href="#23-设置-url-types" title="Direct link to heading">#</a></h4><p>需要在Xcode中设置多个URL Types，URL Types主要是需要设置URL Schemes，其它选项可任意填写。按照下面表格的内容填写，注意替换其中的各项AppID。</p><table><thead><tr><th>URL Schemes</th><th>用途</th><th>示例</th><th>备注</th></tr></thead><tbody><tr><td>XD-{心动AppID}</td><td>用于支付宝支付后跳回</td><td>XD-ci2dos1ktzsca4f</td><td></td></tr><tr><td>{微信AppID}</td><td>用于微信授权登录后跳回</td><td>wx19f231d77ac408d9</td><td></td></tr><tr><td>tencent{QQ AppID}</td><td>用于QQ授权登录后跳回</td><td>tencent317081</td><td>如果给到的心动AppID没有对应的QQ AppID，可以不配置该项</td></tr><tr><td>tt{TapTap AppID}</td><td>用户TapTap授权登录后跳回</td><td>tt123456</td><td></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="24-配置-infoplist"></a>2.4 配置 info.plist<a class="hash-link" href="#24-配置-infoplist" title="Direct link to heading">#</a></h4><p>修改项目的info.plist，在节点中添加下列内容。修改的内容主要为了保证QQ和微信登录能够正常运行。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;array&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;tapsdk&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqq&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqapi&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;wtloginmqq2&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkapiV4&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkapiV3&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkapiV2&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqwpa&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqOpensdkSSoLogin&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqgamebindinggroup&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqqopensdkfriend&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;mqzone&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;weixin&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;wechat&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">// 2.1.0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;string&gt;weixinULAPI&lt;/string&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/array&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;true/&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/dict&gt;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="25-配置工程capability"></a>2.5 配置工程capability<a class="hash-link" href="#25-配置工程capability" title="Direct link to heading">#</a></h4><p>更新SDK 2.1.0之后，需要在xcode工程中添加两项capability：Associated Domains \ Sign in with apple.</p><p>如下图:</p><p><img src="/XDSDK-Doc/assets/images/4-4d6592caef2646f1d917d61f3e27572c.png"></p><p>Associated Domains添加一项，格式为『applinks + 域名』如「applinks:<a href="http://www.xd.com%E3%80%8D%E3%80%82" target="_blank" rel="noopener noreferrer">www.xd.com」。</a></p><p><strong><em>域名为游戏官网地址，请联系平台方确认</em></strong></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="26-处理第三方应用跳回事件"></a>2.6 处理第三方应用跳回事件<a class="hash-link" href="#26-处理第三方应用跳回事件" title="Direct link to heading">#</a></h4><p><strong>在 UnityAppController.mm 中增加如下两个方法，如果已经存在这些方法，在其中追加相应的处理代码即可。请务必添加下列代码，否则将影响第三方登录的授权回调。</strong></p><p><strong>SDK 2.1.0 新增universalLink处理</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">#import &lt;XdComPlatform/XDCore.h&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">- (BOOL)application:(UIApplication*)application openURL:(NSURL*)url sourceApplication:(NSString*)sourceApplication annotation:(id)annotation{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">   return [XDCore HandleXDOpenURL:url];</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary&lt;UIApplicationOpenURLOptionsKey, id&gt; *)options{</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    return [XDCore HandleXDOpenURL:url];</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">- (BOOL)application:(UIApplication *)application continueUserActivity:(NSUserActivity *)userActivity restorationHandler:(void (^)(NSArray&lt;id&lt;UIUserActivityRestoring&gt;&gt; * _Nullable))restorationHandler {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    return [XDCore handleOpenUniversalLink:userActivity];</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="27-buid-settings"></a>2.7 Buid Settings<a class="hash-link" href="#27-buid-settings" title="Direct link to heading">#</a></h4><p>Enable Bitcode = NO</p><p><strong>在编译选项‘Other Linker Flags’中加入「-ObjC」和 「-all_load」。</strong></p><p><strong>Swift Language Version 设置为 Swift 5.0</strong></p><p><strong>BuildSetting中,Always Embed Swift Standard Libraries设置为YES</strong></p><p><strong>BuildSetting中,Runpath Search Paths 确保添加 @executable_path/Frameworks</strong></p><p><strong>如果新版本Untiy导出后有多个Target,只需在主target配置即可。</strong></p><p> 完成以上配置即可进行编译打包。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="服务端对接"></a>服务端对接<a class="hash-link" href="#服务端对接" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-获取用户信息"></a>1. 获取用户信息<a class="hash-link" href="#1-获取用户信息" title="Direct link to heading">#</a></h3><p>游戏服务端使用客户端获取的access token，按照下面的方式获取用户信息。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">接口：https://api.xd.com/v1/user</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">method：GET</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">参数：access_token</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">请求示例：https://api.xd.com/v1/user?access_token=1234</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">成功判断：返回的HTTP Code为200时表示成功，否则失败</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">返回数据格式：application/json</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">返回值示例：</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;id&quot;:&quot;1&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;id_card&quot;:&quot;1111&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;name&quot;:&quot;xdname&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;friendly_name&quot;:&quot;xdfriendly_name&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;client_id&quot;:&quot;abc&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;phone&quot;:&quot;1&quot;,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;safety&quot;:false,</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;site&quot;:&quot;1&quot;}</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">id：用户的ID，注意类型是字符串</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">id_card：加密的身份证号，可能为空</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">name：用户的账号名称</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">friendly_name：用户的昵称，如果游戏想要展现用户名称，建议使用该字段</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">client_id：该用户在该游戏登录时使用的心动AppID</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">phone： 绑定的手机号码</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">safety： 账号是否安全/通过设备二次验证（true：安全，false：不安全）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">site：账号类型, 0 =&gt; vc账号，1 =&gt; 心动账号，3 =&gt; qq账号，8 =&gt; 微信账号，9 =&gt; TapTap账号，注意类型是字符串</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">authoriz_state：0/1/2/3/4（实名状态,0未实名，&gt;0 都表示已实名认证）</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><table><thead><tr><th>应用场景</th><th>参数以及使用方法</th></tr></thead><tbody><tr><td>判断是否游客账号</td><td>游客账号的name和id相同</td></tr><tr><td>判断是否通过二次验证</td><td>safety（0未实名，&gt;0 都表示已实名认证）</td></tr><tr><td>判断账号类型</td><td>site（0 =&gt; vc账号，1 =&gt; 心动账号，3 =&gt; qq账号，8 =&gt; 微信账号，9 =&gt; TapTap账号，注意类型是字符串）</td></tr><tr><td>判断是否实名认证</td><td>authoriz_state（0未实名，&gt;0 都表示已实名认证）</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2--处理支付回调"></a>2	. 处理支付回调<a class="hash-link" href="#2--处理支付回调" title="Direct link to heading">#</a></h3><p>游戏服务端需要提供一个能够处理支付回调的接口，这个接口是申请心动AppID时需要的。处理逻辑中，需要使用一个密钥进行加密验证，该密钥即为心动AppKey。
当心动平台处有充值成功时，心动服务端会通知到支付回调接口，信息如下。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">method：POST</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">数据格式：application/x-www-form-urlencoded</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong><em>注意：请勿信任透传参数</em></strong></p><p>字段如下。</p><table><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>order_id</td><td>number</td><td>心动平台的订单号，相同订单号表示是同一笔支付</td></tr><tr><td>payment</td><td>string</td><td>支付方式，appstore或其它（若回调无该字段，则默认为appstore）</td></tr><tr><td>sub_payment</td><td>string</td><td>子支付方式，Production、Sandbox或其他，为Sandbox表示苹果沙盒充值（值可能为空）</td></tr><tr><td>user_id</td><td>string</td><td>充值用户ID，注意类型是字符串</td></tr><tr><td>client_id</td><td>string</td><td>充值的心动AppID</td></tr><tr><td>app</td><td>string</td><td>同client_id</td></tr><tr><td>app_id</td><td>string</td><td>游戏客户端调用充值时传递的Sid字段</td></tr><tr><td>app_order_id</td><td>string</td><td>游戏客户端调用充值时传递的OrderId字段</td></tr><tr><td>role_id</td><td>string</td><td>游戏客户端调用充值时传递的Role_Id字段</td></tr><tr><td>product_id</td><td>string</td><td>支付购买的商品ID</td></tr><tr><td>gold</td><td>number</td><td>支付实际所付金额，单位元。（仅在客户端使用非AppStore支付方式支付时才有该字段）</td></tr><tr><td>ext</td><td>string</td><td>游戏客户端调用充值时传递的EXT字段</td></tr><tr><td>timestamp</td><td>number</td><td>时间戳，1970年到当前时间的秒数</td></tr><tr><td>sign</td><td>string</td><td>签名校验字段，按照下面的方式进行校验</td></tr></tbody></table><p>签名算法示例，使用php语言。</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">* @param params 类型array，支付回调时收到的参数</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">* @param appKey 类型string，心动AppKey</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">function verify_sign($params, $appKey) {</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$tmp = $params;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">$sign = $tmp[&#x27;sign&#x27;];</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">unset($tmp[&#x27;sign&#x27;]);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ksort($tmp);</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">return strcasecmp($sign, md5(http_build_query($tmp) . $appKey)) == 0;</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><blockquote><p>需要注意</p><p>1、游戏服务端应该按照order_id进行排重，相同order_id仅生效一次。</p></blockquote><p>2、游戏服务端成功处理了支付回调后，应当返回字符串“success”，如果是一笔已经处理的重复的订单，也应该返回“success”。</p><p>3、只要通过签名校验的回调，都应该视为合法数据，按照如下逻辑发放道具。A.如果payment字段为appstore，即AppStore支付，直接按照product_id字段进行道具发放；B.如果payment字段为其它值，需要验证gold字段和 product_id 字段是否相符，如果相符，按照product_id发放道具，如果不相符，直接按照gold字段折算成对应的游戏货币发放。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="广告渠道配置"></a>广告渠道配置<a class="hash-link" href="#广告渠道配置" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-广告部分说明"></a>1. 广告部分说明<a class="hash-link" href="#1-广告部分说明" title="Direct link to heading">#</a></h3><p>XDSDK内部集成了部分主要渠道广告 SDK，包括今日头条巨量广告平台 SDK，和腾讯广点通 SDK。必要事件（如注册）会在 SDK 内部发送，充值事件由 XDSDK 服务端发送事件到相应平台。游戏不用做额外对接工作。</p><p>需要接入相应平台的SDK请联系 XDSDK 后端配置广告参数。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="11-ios"></a>1.1	iOS<a class="hash-link" href="#11-ios" title="Direct link to heading">#</a></h4><p>今日头条：TTTracker.framework，版本2.0.6</p><p>广点通：GDTActionSDK.framework，版本1.4.9</p><p>游戏打包时加入对应的SDK即可。</p><p>注意：</p><ol><li><p>广点通SDK在添加到Link Binary With Libraries之后，还必须添加到Embedded Contend中。</p></li><li><p>build setting 中Other Link Flag 中添加-ObjC。</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="12-android"></a>1.2	Android<a class="hash-link" href="#12-android" title="Direct link to heading">#</a></h4><p>今日头条：版本2.0.6</p><p>广点通：版本1.4.9</p><p>需要使用广告包时，将XDAdAction.aar加入工程。并添加新权限</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">   &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot;/&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>若需要出多个渠道包，由市场联系XDSDK，提供所需文件。</p><p>SDK提供接口，获取当前包的渠道名。（单接TapDB时可以使用改接口获取渠道）</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">//获取当前包的渠道名（安卓）</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">public static string GetAdChannelName()</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="动态-sdk-接入"></a>动态 SDK 接入<a class="hash-link" href="#动态-sdk-接入" title="Direct link to heading">#</a></h2><p>接入动态 SDK 可参考文档 <a href="/XDSDK-Doc/tap-fun-moment">动态 Unity API</a>     </p><blockquote><p>注意：不需要调用 <code>TDSMoment.InitSDK</code> 接口，XDSDK 中已自动处理 </p></blockquote></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/XDSDK-Doc/unity2.x"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Unity2.x快速开始</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/XDSDK-Doc/android"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Android快速开始 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#unity-环境设置及-sdk-资源配置" class="table-of-contents__link">Unity 环境设置及 SDK 资源配置</a><ul><li><a href="#前提条件" class="table-of-contents__link">前提条件</a></li><li><a href="#1-添加-xdsdk-依赖" class="table-of-contents__link">1. 添加 XDSDK 依赖</a></li><li><a href="#2-配置-xdsdk" class="table-of-contents__link">2. 配置 XDSDK</a></li></ul></li><li><a href="#api" class="table-of-contents__link">API</a><ul><li><a href="#1-实现并设置回调方法" class="table-of-contents__link">1. 实现并设置回调方法</a></li><li><a href="#2-配置登录选项" class="table-of-contents__link">2. 配置登录选项</a></li><li><a href="#3-初始化sdk" class="table-of-contents__link">3. 初始化SDK</a></li><li><a href="#4-登录" class="table-of-contents__link">4. 登录</a></li><li><a href="#5-角色信息" class="table-of-contents__link">5. 角色信息</a></li><li><a href="#6-用户中心" class="table-of-contents__link">6. 用户中心</a></li><li><a href="#7-支付" class="table-of-contents__link">7. 支付</a></li><li><a href="#8-登出" class="table-of-contents__link">8. 登出</a></li><li><a href="#9-游客升级" class="table-of-contents__link">9. 游客升级</a></li><li><a href="#10-实名认证" class="table-of-contents__link">10. 实名认证</a></li><li><a href="#11-游客升级" class="table-of-contents__link">11. 游客升级</a></li><li><a href="#12-客服" class="table-of-contents__link">12. 客服</a></li><li><a href="#13-tapdb" class="table-of-contents__link">13. TapDB</a></li><li><a href="#14-防沉迷设置" class="table-of-contents__link">14. 防沉迷设置</a></li><li><a href="#15-taptap-论坛" class="table-of-contents__link">15. TapTap 论坛</a></li><li><a href="#16-xdlive-直播" class="table-of-contents__link">16. XDLive 直播</a></li><li><a href="#17-打开协议页面" class="table-of-contents__link">17. 打开协议页面</a></li><li><a href="#18-地区判断" class="table-of-contents__link">18. 地区判断</a></li><li><a href="#19-排队限流" class="table-of-contents__link">19. 排队限流</a></li></ul></li><li><a href="#原生平台设置" class="table-of-contents__link">原生平台设置</a><ul><li><a href="#1-android-平台设置" class="table-of-contents__link">1. Android 平台设置</a></li><li><a href="#11-android-11-适配" class="table-of-contents__link">1.1 Android 11 适配</a></li><li><a href="#2-ios-平台设置" class="table-of-contents__link">2. iOS 平台设置</a></li></ul></li><li><a href="#服务端对接" class="table-of-contents__link">服务端对接</a><ul><li><a href="#1-获取用户信息" class="table-of-contents__link">1. 获取用户信息</a></li><li><a href="#2--处理支付回调" class="table-of-contents__link">2	. 处理支付回调</a></li></ul></li><li><a href="#广告渠道配置" class="table-of-contents__link">广告渠道配置</a><ul><li><a href="#1-广告部分说明" class="table-of-contents__link">1. 广告部分说明</a></li></ul></li><li><a href="#动态-sdk-接入" class="table-of-contents__link">动态 SDK 接入</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/XDSDK-Doc/styles.04ea6341.js"></script>
<script src="/XDSDK-Doc/runtime~main.2583d833.js"></script>
<script src="/XDSDK-Doc/main.00965467.js"></script>
<script src="/XDSDK-Doc/1.ab684445.js"></script>
<script src="/XDSDK-Doc/2.f8601547.js"></script>
<script src="/XDSDK-Doc/22.95066253.js"></script>
<script src="/XDSDK-Doc/935f2afb.84422a50.js"></script>
<script src="/XDSDK-Doc/17896441.f8f7aa8e.js"></script>
<script src="/XDSDK-Doc/df7c724d.1dabc689.js"></script>
</body>
</html>